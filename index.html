<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.319">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Masumbuko Semba">
<meta name="dcterms.date" content="2023-06-23">

<title>Remote Sensing and GIS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="style_mie.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#file-and-folder-management" id="toc-file-and-folder-management" class="nav-link" data-scroll-target="#file-and-folder-management">File and folder management</a></li>
  <li><a href="#coding-and-code-management" id="toc-coding-and-code-management" class="nav-link" data-scroll-target="#coding-and-code-management">Coding and code management</a>
  <ul class="collapse">
  <li><a href="#why-write-code" id="toc-why-write-code" class="nav-link" data-scroll-target="#why-write-code"><strong>Why write code?</strong></a></li>
  <li><a href="#some-coding-rules" id="toc-some-coding-rules" class="nav-link" data-scroll-target="#some-coding-rules"><strong>Some coding rules</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#computing-environment-and-software" id="toc-computing-environment-and-software" class="nav-link" data-scroll-target="#computing-environment-and-software">Computing environment and software</a>
  <ul class="collapse">
  <li><a href="#sec-software" id="toc-sec-software" class="nav-link" data-scroll-target="#sec-software">Software installation and setup</a></li>
  <li><a href="#a-quick-note-on-the-structure-of-this-tutorial" id="toc-a-quick-note-on-the-structure-of-this-tutorial" class="nav-link" data-scroll-target="#a-quick-note-on-the-structure-of-this-tutorial">A quick note on the structure of this tutorial</a></li>
  </ul></li>
  <li><a href="#handling-spatial-data-in-r" id="toc-handling-spatial-data-in-r" class="nav-link" data-scroll-target="#handling-spatial-data-in-r">Handling Spatial Data in R</a>
  <ul class="collapse">
  <li><a href="#introduction-spatial-data" id="toc-introduction-spatial-data" class="nav-link" data-scroll-target="#introduction-spatial-data">Introduction Spatial Data</a>
  <ul class="collapse">
  <li><a href="#vector-data" id="toc-vector-data" class="nav-link" data-scroll-target="#vector-data">Vector data</a></li>
  <li><a href="#raster-data" id="toc-raster-data" class="nav-link" data-scroll-target="#raster-data">Raster data</a></li>
  </ul></li>
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages">loading packages</a></li>
  <li><a href="#loading-spatial-data" id="toc-loading-spatial-data" class="nav-link" data-scroll-target="#loading-spatial-data">Loading spatial Data</a>
  <ul class="collapse">
  <li><a href="#point-data" id="toc-point-data" class="nav-link" data-scroll-target="#point-data">Point Data</a></li>
  <li><a href="#line-data" id="toc-line-data" class="nav-link" data-scroll-target="#line-data">Line Data</a></li>
  <li><a href="#polygon-data" id="toc-polygon-data" class="nav-link" data-scroll-target="#polygon-data">Polygon Data</a></li>
  <li><a href="#raster-data-1" id="toc-raster-data-1" class="nav-link" data-scroll-target="#raster-data-1">Raster Data</a></li>
  </ul></li>
  <li><a href="#visualizing-spatial-data" id="toc-visualizing-spatial-data" class="nav-link" data-scroll-target="#visualizing-spatial-data">Visualizing Spatial Data</a>
  <ul class="collapse">
  <li><a href="#plotting-vector-data-types" id="toc-plotting-vector-data-types" class="nav-link" data-scroll-target="#plotting-vector-data-types">Plotting vector Data Types</a></li>
  <li><a href="#plotting-raster-data" id="toc-plotting-raster-data" class="nav-link" data-scroll-target="#plotting-raster-data">Plotting Raster Data</a></li>
  </ul></li>
  <li><a href="#manipulating-spatial-data" id="toc-manipulating-spatial-data" class="nav-link" data-scroll-target="#manipulating-spatial-data">Manipulating Spatial Data</a>
  <ul class="collapse">
  <li><a href="#sec-crop" id="toc-sec-crop" class="nav-link" data-scroll-target="#sec-crop">Cropping raster</a></li>
  <li><a href="#sec-mask" id="toc-sec-mask" class="nav-link" data-scroll-target="#sec-mask">Masking raster</a></li>
  <li><a href="#sec-extract" id="toc-sec-extract" class="nav-link" data-scroll-target="#sec-extract">Extracting elevation values</a></li>
  </ul></li>
  <li><a href="#temperature" id="toc-temperature" class="nav-link" data-scroll-target="#temperature">Temperature</a></li>
  <li><a href="#derivatives-from-raster" id="toc-derivatives-from-raster" class="nav-link" data-scroll-target="#derivatives-from-raster">Derivatives from raster</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul class="collapse">
  <li><a href="#vector-data-issues" id="toc-vector-data-issues" class="nav-link" data-scroll-target="#vector-data-issues">vector data issues</a></li>
  <li><a href="#spatial-resolution-in-raster" id="toc-spatial-resolution-in-raster" class="nav-link" data-scroll-target="#spatial-resolution-in-raster">Spatial resolution in Raster</a></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information">Session Information</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Remote Sensing and GIS</h1>
<p class="subtitle lead">Handling Vector and Raster Data in R</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Masumbuko Semba </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            The Nelson Mandela African Institution of Science and Technology
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 23, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This exercise provides an introductory overview of spatial data , but it only scratches the surface of this vast field. For a more comprehensive understanding and in-depth analysis of spatial data, it is recommended to refer to specialized reference books like <em>Geospatial Technology and Spatial Analysis in R</em> written by Masumbuko Semba . This book delves into the intricacies of spatial data analysis, offering valuable insights and practical guidance. To access further details and explore the topic extensively, you can visit the following link: https://lugoga.github.io/spatialgoR/ch1.html. It serves as a valuable resource for expanding your knowledge and expertise in spatial data analysis.</p>
<p>In addition to a book on <em>spatial data analysis in R</em>, Semba has also written a book that focuses on handling spatial data in coastal and marine environmental contexts. Although the book has a specific focus, the concepts and methodologies discussed can be applied to other fields such as hydrology and related disciplines. The book offers valuable insights into effectively working with spatial data in coastal and marine environments. To access the book and explore its content, you can visit the following URL: https://lugoga.github.io/geomarine/intro.html. This resource serves as a useful reference for those interested in understanding and analyzing spatial data in the context of coastal and marine environments, while also offering potential applications in related fields.</p>
<p>Furthermore, Semba maintains blogs and websites where he shares informative blog posts discussing solutions for handling, manipulating, visualizing, analyzing, and modeling both spatial and non-spatial data using R and Python programming languages. These resources also touch upon sharing information through web technologies and the development of data-driven and interactive web applications to support decision-making processes. Some of these blogs include “Ngara” (https://lugoga.github.io/semba-quarto/) and “Semba-Blog” (https://semba-blog.netlify.app/post/). Additionally, Semba has developed a web application that can be accessed at the following link: https://semba.shinyapps.io/vizingaApp/. These resources serve as valuable references for those interested in exploring data-related techniques and tools in the context of spatial and non-spatial data analysis, as well as web development for decision support applications.</p>
<p>In this exercise, we will be using different types of spatial data to analyze the Arusha region in Tanzania. The point data represents randomly selected sampling points, the line shape represents rivers, and the polygon represents regions in Tanzania. Additionally, we will be using a raster dataset of elevation in Tanzania. The data will be used for spatial analysis, which employs various techniques to analyze spatial data. This exercise will allow us to gain insights into the geography, hydrology, and other aspects of the Arusha region.</p>
<p>This exercise gives the basics on installing <a href="https://cran.r-project.org/"><strong>R</strong></a> and <a href="https://www.rstudio.com/products/RStudio/"><strong>RStudio</strong></a>, CRAN spatial Task Views and. Obviously, if you're already familiar with these topics then no need to go through that post.</p>
<p>Our focus will be on importing spatial data (vector and raster) into R and and explore them to understand thow the spatial data are handled and presented in this language. We will use different library such as sf, terra, tidyverse etc along with a few others to achieve our objectives.</p>
<p>Our example will cover a range of topics, including installing R, Rstudio and packages, setting our working directory, importing data, plotting, visualizing spatial data, cropping, masking and derive derivatives of elevation dataset for Arusha region.</p>
<p>By the end of this session, you will have a solid understanding of how to work with vector and raster data in R and be able to apply these techniques to your own projects. So, let’s dive in and get started!</p>
<section id="file-and-folder-management" class="level2">
<h2 class="anchored" data-anchor-id="file-and-folder-management">File and folder management</h2>
<p>Project files and folders can get unwieldy fast, and can really bog you down and inhibit productivity when you don’t know where your files are or what the latest version is. The two main considerations for addressing this issue are</p>
<ol type="a">
<li>defining a simple, common, intuitive <strong>folder structure</strong>, and</li>
<li>using informative <strong>file names</strong>.</li>
</ol>
<p>Your naming conventions should be:</p>
<ul>
<li>machine readable
<ul>
<li>i.e.&nbsp;avoid spaces and funny punctuation</li>
<li>support searching and splitting of names (e.g.&nbsp;“data_raw_precip.csv”, “data_clean_precip.csv”, “data_raw_species.csv” can all be searched by keywords and can be split by “_” into 3 useful fields: type (data vs ot”er), class (raw vs clean), variable (precip vs species), etc)</li>
</ul></li>
<li>human readable
<ul>
<li>the contents should be self evident from the file name</li>
</ul></li>
<li>support sorting
<ul>
<li>i.e.&nbsp;use numeric or character prefixes to separate files into different components or steps (e.g.&nbsp;“data_raw_localities.csv”, “data_clean_localities.csv”, etc)</li>
<li>some of this can be handled with folder structure, but you don’t want too many folders either</li>
</ul></li>
</ul>
<p>Find out more about file naming <a href="https://bookdown.org/content/d1e53ac9-28ce-472f-bc2c-f499f18264a3/names.html">here</a>.</p>
</section>
<section id="coding-and-code-management" class="level2">
<h2 class="anchored" data-anchor-id="coding-and-code-management">Coding and code management</h2>
<section id="why-write-code" class="level3">
<h3 class="anchored" data-anchor-id="why-write-code"><strong>Why write code?</strong></h3>
<p>Working in point-and-click GUI-based software like Excel, Statistica, SPSS, etc may seem easier, but you’ll regret it in the long run…</p>
<p>The beauty of writing code lies in:</p>
<ul>
<li><strong>Automation</strong>
<ul>
<li>You will inevitably have to adjust and repeat your analysis as you get feedback from supervisors, collaborators and reviewers. Rerunning code is one click, and you’re unlikely to introduce errors. Rerunning analyses in GUI-based software is lots of clicks and it’s easy to make mistakes, alter default settings, etc etc.</li>
<li>Next time you need to do the same analysis on a different dataset you can just copy, paste and tweak your code.</li>
</ul></li>
<li>You code/script provides a <strong>record of your analysis</strong></li>
<li>Linked to the above, mature scientific coding languages like Python or R allow you to <strong>run almost any kind of analysis in one scripted workflow</strong>, even if it has diverse components like GIS, phylogenetics, multivariate or Bayesian statistics, etc.
<ul>
<li>Most proprietary software are limited to one or a few specialized areas (e.g.&nbsp;ArcGIS, etc), which leaves you manually exporting and importing data between multiple software packages. This is very cumbersome, in addition to being a file-management nightmare…</li>
</ul></li>
<li>Most scripting environments are <strong>open source</strong> (e.g.&nbsp;R, Python, JavaScript, etc)
<ul>
<li>Anyone wanting to use your code doesn’t have to pay for a software license</li>
<li>It’s great for transparency - Lots of people can and have checked the background code and functions you’re using, versus only the software owner’s employees have access to the raw code for most analytical software</li>
<li>There’s usually a culture of sharing code (online forums, with publications, etc)</li>
</ul></li>
</ul>
<p><a href="https://fynbos.saeon.ac.za/docs/learningr/why-learn-r/">Here’s</a> a motivation and some tutorials to help you learn R.</p>
</section>
<section id="some-coding-rules" class="level3">
<h3 class="anchored" data-anchor-id="some-coding-rules"><strong>Some coding rules</strong></h3>
<p>It’s easy to write messy code. This can make it virtually indecipherable to others (and even yourself), slowing you and your collaborations down. It also makes it easy to make mistakes and not notice them. The overarching rule is to <strong><em>write code for people</em></strong>, not computers. Check out the <a href="https://style.tidyverse.org/index.html">Tidyverse style guide</a> for R-specific guidance, but here are some basic rules:</p>
<ul>
<li>use consistent, meaningful and distinct names for variables and functions</li>
<li>use consistent code and formatting style</li>
<li>use commenting to document and explain what you’re doing at each step or in each function - purpose, inputs and outputs</li>
<li>“notebooks” like RMarkdown or Jupyter Notebooks are very handy for fulfilling roles like documentation, master/makefiles etc and can be developed into reports or manuscripts</li>
<li>write functions rather than repeating the same code</li>
<li>modularize code into manageable steps/chunks
<ul>
<li>or even separate them into separate scripts that can all be called in order from a master script or Makefile</li>
</ul></li>
<li>check for mistakes at every step!!! Beyond errors or warnings, do the outputs make sense?</li>
<li>start with a “recipe” that outlines the steps/modules (usually as commented headers etc). This is very valuable for keeping you organized and on track, e.g.&nbsp;a common recipe in R:
<ul>
<li>Header indicating purpose, author, date, version etc</li>
<li>Define settings</li>
<li>Load required libraries</li>
<li>Read in data</li>
<li>Wrangle/reformat/clean/summarize data as required</li>
<li>Run analyses (often multiple steps)</li>
<li>Wrangle/reformat/summarize analysis outputs for visualization</li>
<li>Visualize outputs as figures or tables</li>
</ul></li>
<li>avoid proprietary formats
<ul>
<li>i.e.&nbsp;use an open source scripting langauge and open source file formats only</li>
</ul></li>
<li>use version control!!!</li>
</ul>
<!-- **Version control** -->
<!-- Using version control tools like Git, SVN, etc can be challenging at first, but they can also hugely simplify your code development (and adaptation) process. While they were designed by software developers for software development, they are hugely useful for quantitative biology. -->
<!-- I can't speak authoritatively on version control systems (I've only ever used Git and [GitHub](https://github.com/)), but here are the advantages as I see them. This version is specific to Git, but I imagine they all have similar functions and functionality: -->
<!-- > Words in *italics* are technical terms used within GitHub. You can look them up [here](https://docs.github.com/en/get-started/quickstart). You'll also cover it in the brief tutorial you'll do when setting up your computer for the practical. -->
<!-- -   They generally help project management, especially **collaborations** -->
<!-- -   They allow you to **easily share code** with collaborators or the public at large - through *repositories* or *gists* (code snippets) -->
<!-- -   Users can easily **adapt or build on each others' code** by *forking* repositories and working on their own *branch*. -->
<!--     -   This is truly powerful!!! It allows you to **repeat/replicate analyses** but even build websites (like this one!), etc -->
<!-- -   While the whole **system is online**, you **can also work offline** by *cloning* the *repository* to your local machine. Once you have a local version you can *push* to or *pull* from the online repository to keep everything updated -->
<!-- -   **Changes are tracked and reversible** through *commits*. If you change the contents of a *repository* you must *commit* them and write a *commit message* before pulling or pushing to the online *repository*. Each *commit* is essentially a recoverable *version* that can be *compared* or *reverted* to -->
<!--     -   This is **the essence of version control** and magically frees you from folders full of lists of files named "mycode_final.R", "mycode_finalfinal.R", "myfinalcode_finalfinal.R" etc as per Figure \@ref(fig:documentnaming) -->
<!-- -   They allow collaborators or the public at large to **propose changes** via *pull requests* that allow you to *merge* their *forked branch* back to the *main (or master) branch* -->
<!-- -   They allow you to **accept and integrate changes seamlessly** when you accept and merge *pull requests* -->
<!-- -   They allow you to **keep written record of changes** through comments whenever a *commit* or *pull request* is made - these also track the user, date, time, etc and are useful for *blaming* when things go wrong -->
<!-- -   There's a system for ***assigning*** **logging and tracking *issues* and *feature requests*** -->
<!-- I'm sure this is all a bit much right now, but should make more sense after the practical... -->
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="computing-environment-and-software" class="level1">
<h1>Computing environment and software</h1>
<p>You’ve heard why you should <strong>use open source software</strong> whenever possible, but it bears repeating. Using proprietary software means that others have to purchase software, licenses, etc to build on your work and essentially makes it not reproducible by putting it behind a pay-wall. This is self-defeating…</p>
<p>Another issue is that <strong>software and hardware change with upgrades, new versions or changes in the preferences within user communities</strong> (e.g.&nbsp;you’ll all know MicroSoft Excel, but have you heard of Quattro Pro or Lotus that were the preferred spreadsheet software of yesteryear?).</p>
<p>Just sharing your code, data and workflow does not make your work reproducible if we don’t know what language the code is written in or if functions change or are deprecated in newer versions, breaking your code.</p>
<p>The <strong>simplest way</strong> to avert this problem is to <strong>carefully document the hardware and versions of software</strong> used in your analyses so that others can recreate that computing environment if needed. This is very easy in R, because you can simply run the <code>sessionInfo()</code> function, like so:</p>
<section id="sec-software" class="level2">
<h2 class="anchored" data-anchor-id="sec-software">Software installation and setup</h2>
<p>For this exercise, we’ll be using the <a href="https://cran.r-project.org/">R</a> statistical programming language <span class="citation" data-cites="rlanguage">(<a href="#ref-rlanguage" role="doc-biblioref">R Core Team 2023</a>)</span>. We’ll also be using an <a href="https://en.wikipedia.org/wiki/Integrated_development_environment">integrated development environment (IDE)</a> for each: <a href="https://www.rstudio.com">RStudio</a>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong><em>If you already have these installed and set up</em></strong>, please make sure you have the latest versions, and check that your installations are working! Please also make sure you have installed (and/or updated) the <a href="https://www.tidyverse.org/"><em>Tidyverse</em></a> set of R packages. It can be installed using the code <code>install.packages("tidyverse")</code> and updated using <code>update.packages("tidyverse")</code></p>
</div>
</div>
<p>The installation and setup can be a bit long-winded, but once done you should be good to go until you change or reformat your computer. The steps below are my summary and (hopefully) more intuitive adaptation of the instructions provided for installing and run R and Rstudio in your machine.</p>
<p>First we’ll start with the necessary software.</p>
<ol type="1">
<li>Download and install the <strong><em>latest</em></strong> version of <a href="https://cran.r-project.org/">R</a></li>
<li>Download and install the <strong><em>latest</em></strong> free version of <a href="https://www.rstudio.com/products/rstudio/download/">RStudio Desktop</a></li>
<li>Lastly, you need to install the packages we will need for this session. To begin with, we are going to install few packages, which include <strong>tidyverse</strong> <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>, <strong>terra</strong> <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span>, <strong>sf</strong> <span class="citation" data-cites="sf">(<a href="#ref-sf" role="doc-biblioref">Pebesma 2018</a>)</span>, and <strong>tidyterra</strong> <span class="citation" data-cites="tidyterra">(<a href="#ref-tidyterra" role="doc-biblioref">Hernangómez 2023</a>)</span> packages. This can be done using the code:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>my.packages <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"terra"</span>, <span class="st">"tidyterra"</span>, <span class="st">"sf"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">install.packages</span>(my.packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="a-quick-note-on-the-structure-of-this-tutorial" class="level2">
<h2 class="anchored" data-anchor-id="a-quick-note-on-the-structure-of-this-tutorial">A quick note on the structure of this tutorial</h2>
<p>From here this tutorial will include embedded chunks of R code and the output that R returns in little grey boxes. The R code I call starts at the beginning of the line, while each line of R's output starts with "##", e.g.</p>
<pre><code>1+1</code></pre>
<pre><code>## [1] 2</code></pre>
<p>Note that I occassionally include additional comments in the R chunks as one often does in normal R code. Comments are preceded by "#", e.g.</p>
<pre><code>1+1 #My comment</code></pre>
<pre><code>## [1] 2</code></pre>
<p>Hopefully this will all make sense as you get into the tutorial…</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="handling-spatial-data-in-r" class="level1">
<h1>Handling Spatial Data in R</h1>
<p>This tutorial will guide you through the process of importing and handling spatial data in R. We will cover how to import point, lines, polygon, and raster data using the <code>sf</code> and <code>terra</code> packages.</p>
<p>spatial data refers to data that has a geographic component, such as point locations, lines, polygons, and raster images. R is a powerful tool for handling and analyzing spatial data, with several packages available for importing, manipulating, and visualizing spatial data. In this tutorial, we will cover the basics of handling spatial data in R, starting with importing point, line, polygon, and raster data.</p>
<section id="introduction-spatial-data" class="level2">
<h2 class="anchored" data-anchor-id="introduction-spatial-data">Introduction Spatial Data</h2>
<p>Spatial phenomena can generally be thought of as either discrete objects with clear boundaries or as a continuous phenomena that can be observed everywhere <span class="citation" data-cites="wior">(<a href="#ref-wior" role="doc-biblioref">Semba and Peter 2023</a>)</span>, but that do not have natural boundaries. Discrete spatial objects may refer to a river, road, country, town, or a research site. Examples of continuous phenomena, or “spatial fields”, include elevation, temperature, and air quality.</p>
<p>Spatial objects are usually represented by vector data <span class="citation" data-cites="geospatial">(<a href="#ref-geospatial" role="doc-biblioref">Semba, Peter, and Andrew</a>)</span>. Such data consists of a description of the “geometry” or “shape” of the objects <span class="citation" data-cites="geomarine">(<a href="#ref-geomarine" role="doc-biblioref">Semba</a>)</span>, and normally also includes additional variables. For example, a vector data set may represent the borders of the countries of the world (geometry), and also store their names and the size of their population in 2015; or it may have the geometry of the roads in an area, as well as their type and names. These additional variables are often referred to as “attributes”. Continuous spatial data (fields) are usually represented with a raster data structure. We discuss these two data types in turn.</p>
<section id="vector-data" class="level3">
<h3 class="anchored" data-anchor-id="vector-data">Vector data</h3>
<p>The main vector data types are points, lines and polygons <span class="citation" data-cites="sf geospatial">(<a href="#ref-sf" role="doc-biblioref">Pebesma 2018</a>; <a href="#ref-geospatial" role="doc-biblioref">Semba, Peter, and Andrew</a>)</span>. In all cases, the geometry of these data structures consists of sets of coordinate pairs (x, y). Points are the simplest case. Each point has one coordinate pair, and n associated variables. For example, a point might represent a place where a rat was trapped, and the attributes could include the date it was captured, the person who captured it, the species size and sex, and information about the habitat. It is also possible to combine several points into a multi-point structure, with a single attribute record. For example, all the coffee shops in a town could be considered as a single geometry.</p>
<p>The geometry of lines is a just a little bit more complex. First note that in this context, the term ‘line’ refers to a set of one or more polylines (connected series of line segments). For example, in spatial analysis, a river and all its tributaries could be considered as a single ‘line’ (but they could also also be several lines, perhaps one for each tributary river). Lines are represented as ordered sets of coordinates (nodes). The actual line segments can be computed (and drawn on a map) by connecting the points. Thus, the representation of a line is very similar to that of a multi-point structure. The main difference is that for a line the ordering of the points is important, because we need to know in which order the points should be connected.</p>
<p>A network (e.g.&nbsp;a road or river network), or spatial graph, is a special type of lines geometry where there is additional information about things like flow, connectivity, direction, and distance.</p>
<p>A polygon refers to a set of closed polylines. The geometry is very similar to that of lines, but to close a polygon the last coordinate pair coincides with the first pair. A complication with polygons is that they can have holes (that is a polygon entirely enclosed by another polygon, that serves to remove parts of the enclosing polygon (for example to show an island inside a lake. Also, valid polygons do not self-intersect (but it is OK for a line to self-cross). Again, multiple polygons can be considered as a single geometry. For example, Indonesia consists of many islands. Each island can be represented by a single polygon, but together then can be represent a single (multi-) polygon representing the entire country.</p>
</section>
<section id="raster-data" class="level3">
<h3 class="anchored" data-anchor-id="raster-data">Raster data</h3>
<p>raster data is commonly used to represent spatially continuous phenomena such as elevation <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span>. A raster divides the world into a grid of equally sized rectangles (referred to as cells or, in the context of satellite remote sensing, pixels) that all have one or more values (or missing values) for the variables of interest <span class="citation" data-cites="geospatial">(<a href="#ref-geospatial" role="doc-biblioref">Semba, Peter, and Andrew</a>)</span>. A raster cell value should normally represent the average (or majority) value for the area it covers. However, in some cases the values are actually estimates for the center of the cell (in essence becoming a regular set of points with an attribute).</p>
<p>In contrast to vector data, in raster data the geometry is not explicitly stored as coordinates. It is implicitly set by knowing the spatial extent and the number or rows and columns in which the area is divided <span class="citation" data-cites="tidyterra">(<a href="#ref-tidyterra" role="doc-biblioref">Hernangómez 2023</a>)</span>. From the extent and number of rows and columns, the size of the raster cells (spatial resolution) can be computed. While raster cells can be thought of as a set of regular polygons, it would be very inefficient to represent the data that way as coordinates for each cell would have to be stored explicitly. Doing so would also dramatically increase processing time.</p>
</section>
</section>
<section id="loading-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-packages">loading packages</h2>
<p>First, make sure you have the necessary packages installed and loaded on your machine. The packages we will be using are <code>sf</code>, <code>tidyverse</code>, and <code>terra</code>. You can install and load these packages using the following code in Rstudio:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"sf"</span>, <span class="st">"tidyverse"</span>, <span class="st">"terra"</span>, <span class="st">"gt))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then load them in our session using <code>library</code> function;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-7-1" class="code-annotation-target"><a href="#annotated-cell-7-1"></a><span class="fu">library</span>(sf)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2"></a><span class="fu">library</span>(tidyverse)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-7-3" class="code-annotation-target"><a href="#annotated-cell-7-3"></a><span class="fu">library</span>(terra)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4"></a><span class="fu">require</span>(gt)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="1" data-code-annotation="1">load sf package</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="2">load tidyverse package</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="3" data-code-annotation="3">load terra and; then</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="4">load gt</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="loading-spatial-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-spatial-data">Loading spatial Data</h2>
<section id="point-data" class="level3">
<h3 class="anchored" data-anchor-id="point-data">Point Data</h3>
<p>To import point data in R, we can use the <strong>sf</strong> package. This package provides a simple and efficient way to work with spatial data in R. To import point data from a shapefile, we can use the <code>st_read()</code> function. Here is an example code:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-8-1" class="code-annotation-target"><a href="#annotated-cell-8-1"></a>sampling.points <span class="ot">=</span> <span class="fu">st_read</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2"></a>  <span class="at">dsn =</span> <span class="st">"data/sampling_points.gpkg"</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-8-3" class="code-annotation-target"><a href="#annotated-cell-8-3"></a>  <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="annotated-cell-8-4"><a href="#annotated-cell-8-4"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="1" data-code-annotation="1">specify the function</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="2">define the path and file</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="3" data-code-annotation="3">prevent the document printing in console</span>
</dd>
</dl>
</div>
</div>
<p>Let’s us explore what is contained in the sampling points. It’s important to remember that vector data model should have a spatial dimension and an attribute information that describe the information of each feature</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>sampling.points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 30 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 35.08742 ymin: -3.915823 xmax: 36.95439 ymax: -1.800931
Geodetic CRS:  WGS 84
First 10 features:
         name                       geom
1   station_1     POINT (36.853 -3.4023)
2   station_2  POINT (36.6334 -3.017127)
3   station_3   POINT (35.47925 -2.4742)
4   station_4 POINT (35.12118 -3.674647)
5   station_5  POINT (36.7901 -2.687773)
6   station_6 POINT (36.95439 -2.939174)
7   station_7 POINT (36.34118 -2.651372)
8   station_8 POINT (36.38371 -3.915823)
9   station_9 POINT (35.60775 -2.240748)
10 station_10 POINT (35.46656 -1.909838)</code></pre>
</div>
</div>
</section>
<section id="line-data" class="level3">
<h3 class="anchored" data-anchor-id="line-data">Line Data</h3>
<p>To import line data in R, we can use the same s<code>t_read()</code> function as for point data. Here is an example code:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>rivers <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/rivers.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>rivers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 199 features and 2 fields
Geometry type: MULTILINESTRING
Dimension:     XY
Bounding box:  xmin: 29.7495 ymin: -11.67632 xmax: 40.4299 ymax: -0.9867556
Geodetic CRS:  WGS 84
First 10 features:
   Id River_Name                           geom
1   0       Mara MULTILINESTRING ((33.93129 ...
2   0       Mara MULTILINESTRING ((34.01076 ...
3   0   Gurumeti MULTILINESTRING ((33.80141 ...
4   0     Orangi MULTILINESTRING ((34.48343 ...
5   0  Nyabogati MULTILINESTRING ((35.15211 ...
6   0  Mhalageti MULTILINESTRING ((33.82517 ...
7   0       Duma MULTILINESTRING ((33.43835 ...
8   0       Duma MULTILINESTRING ((33.80104 ...
9   0     Simiyu MULTILINESTRING ((33.40786 ...
10  0  Lolgorien MULTILINESTRING ((35.9242 -...</code></pre>
</div>
</div>
</section>
<section id="polygon-data" class="level3">
<h3 class="anchored" data-anchor-id="polygon-data">Polygon Data</h3>
<p>To import polygon data in R, we can use the same st_read() function as for point and line data. Here is an example code:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>regions <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/regions_poly.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>regions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 32 features and 8 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 29.29227 ymin: -11.76044 xmax: 40.45468 ymax: -0.9989721
Geodetic CRS:  WGS 84
First 10 features:
   FID_TZ_REG ID TZ_REGIONA FID_TZREGI ID_1 AREA CCRO CRO
1           2  0     NJOMBE         -1    0    0    0   0
2           3  0      LINDI         -1    0    0    0   0
3           4  0     IRINGA         -1    0    0    0   0
4           6  0      RUKWA         -1    0    0    0   0
5          10  0     KATAVI         -1    0    0    0   0
6          11  0     DODOMA         -1    0    0    0   0
7          12  0      TANGA         -1    0    0    0   0
8          13  0     TABORA         -1    0    0    0   0
9          14  0    SINGIDA         -1    0    0    0   0
10         15  0    MANYARA         -1    0    0    0   0
                             geom
1  MULTIPOLYGON (((34.7738 -8....
2  MULTIPOLYGON (((39.25599 -8...
3  MULTIPOLYGON (((34.93377 -6...
4  MULTIPOLYGON (((30.9412 -7....
5  MULTIPOLYGON (((31.11722 -5...
6  MULTIPOLYGON (((37.04439 -5...
7  MULTIPOLYGON (((38.79985 -5...
8  MULTIPOLYGON (((33.6004 -3....
9  MULTIPOLYGON (((34.78736 -3...
10 MULTIPOLYGON (((35.83085 -3...</code></pre>
</div>
</div>
<div id="exm-sf" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 </strong></span>Which function within the sf package should be used to import vector data modal in R?</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>To read simple feature spatial data into R, you can use the <code>st_read()</code> function from the <strong>sf</strong> package. This function can read spatial data from various file formats, including shapefiles, geopackages, GeoJSON, and KML files.</p>
</div>
</section>
<section id="raster-data-1" class="level3">
<h3 class="anchored" data-anchor-id="raster-data-1">Raster Data</h3>
<p>To import raster data in R, we can use the <strong>terra</strong> package. This package provides a fast and efficient way to work with raster data in R. To import a raster image from a file, we can use the <em>rast()</em> function. Here is an example code:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>elevation <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"data/wc2.1_country/TZA_wc2.1_30s_elev.tif"</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>elevation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 1380, 1380, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 29, 40.5, -12, -0.5  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : TZA_wc2.1_30s_elev.tif 
name        : TZA_wc2.1_30s_elev 
min value   :                 -1 
max value   :               5778 </code></pre>
</div>
</div>
<div id="exm-sf" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 </strong></span>Which function in terra package is used to read and import raster data modal in R?</p>
</div>
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>The <code>rast()</code> function in the terra package is used to read raster datasets into R. It allows for the efficient loading and manipulation of raster data, providing access to various operations and analysis on the raster objects.</p>
</div>
</section>
</section>
<section id="visualizing-spatial-data" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-spatial-data">Visualizing Spatial Data</h2>
<section id="plotting-vector-data-types" class="level3">
<h3 class="anchored" data-anchor-id="plotting-vector-data-types">Plotting vector Data Types</h3>
<p>Once we have imported our spatial data into R, we can manipulate it using various functions provided by the <strong>sf</strong> and <strong>terra</strong> packages. For example, we can plot our spatial data using the <code>plot()</code> function. Here is an example code:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a>stations <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/sampling_points.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>stations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 30 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 35.08742 ymin: -3.915823 xmax: 36.95439 ymax: -1.800931
Geodetic CRS:  WGS 84
First 10 features:
         name                       geom
1   station_1     POINT (36.853 -3.4023)
2   station_2  POINT (36.6334 -3.017127)
3   station_3   POINT (35.47925 -2.4742)
4   station_4 POINT (35.12118 -3.674647)
5   station_5  POINT (36.7901 -2.687773)
6   station_6 POINT (36.95439 -2.939174)
7   station_7 POINT (36.34118 -2.651372)
8   station_8 POINT (36.38371 -3.915823)
9   station_9 POINT (35.60775 -2.240748)
10 station_10 POINT (35.46656 -1.909838)</code></pre>
</div>
</div>
<p>The printed sampling station provide a metadata that describe the given data is a simple feature collection with 30 features and 1 field. The geometry type is a point, and the dimension is XY. The bounding box is defined by the minimum and maximum values of the x and y coordinates. The geodetic CRS is WGS 84. The data contains 30 points, each representing a station, with the name of the station and its corresponding latitude and longitude coordinates. The data can be plotted using <code>plot</code> function in R, the code in the chunk highlight;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>stations <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sp1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-sp1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Sampling points plotted with plot function</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The plot function has plotted the sampling station by station name. Its not very clear here as the spatial information in the plot is missing. Though a <code>plot</code> function is useful for visualizing spatial data in R, but Plotting spatial data with <strong>ggplot2</strong> is more intuitive and is the one I prefer. This is because it use a concept of grammer of graphics (gg) and its code syntax are easy to read and follow. To plot any data in <strong>ggplot2</strong> <span class="citation" data-cites="ggplot">(<a href="#ref-ggplot" role="doc-biblioref">Wickham 2016</a>)</span>, the key steps include</p>
<ol type="1">
<li>Use the <code>ggplot()</code> function to initiate the plot and specify the data source.</li>
<li>Add the desired layers to the plot using <code>geom_sf()</code> for spatial data. <strong>ggplot2</strong> offers several <code>geoms_</code> for non-spatial data.</li>
<li>Customize the plot using <strong>ggplot2</strong> functions such as <code>labs()</code>, <code>scale_()</code>, and <code>theme_()</code>.</li>
</ol>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stations) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">geom_sf</span>()<span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Points"</span>, </span>
<span id="cb20-4"><a href="#cb20-4"></a>       <span class="at">subtitle =</span> <span class="st">"Hyrological Sampling Stations"</span>, </span>
<span id="cb20-5"><a href="#cb20-5"></a>       <span class="at">y =</span> <span class="st">"Latitude"</span>, </span>
<span id="cb20-6"><a href="#cb20-6"></a>       <span class="at">x =</span> <span class="st">"Longitude"</span>,</span>
<span id="cb20-7"><a href="#cb20-7"></a>       <span class="at">caption =</span> <span class="st">"Source: NM-AIST"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sp2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-sp2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Sampling points plotted ggplot2 package</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Similarly, we can plot line and polygon data using the same plot() function. Let’s load our river dataset into the session using <code>st_read()</code> function and specify the directory path where our river dataset is stored;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>rivers <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/rivers.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>rivers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 199 features and 2 fields
Geometry type: MULTILINESTRING
Dimension:     XY
Bounding box:  xmin: 29.7495 ymin: -11.67632 xmax: 40.4299 ymax: -0.9867556
Geodetic CRS:  WGS 84
First 10 features:
   Id River_Name                           geom
1   0       Mara MULTILINESTRING ((33.93129 ...
2   0       Mara MULTILINESTRING ((34.01076 ...
3   0   Gurumeti MULTILINESTRING ((33.80141 ...
4   0     Orangi MULTILINESTRING ((34.48343 ...
5   0  Nyabogati MULTILINESTRING ((35.15211 ...
6   0  Mhalageti MULTILINESTRING ((33.82517 ...
7   0       Duma MULTILINESTRING ((33.43835 ...
8   0       Duma MULTILINESTRING ((33.80104 ...
9   0     Simiyu MULTILINESTRING ((33.40786 ...
10  0  Lolgorien MULTILINESTRING ((35.9242 -...</code></pre>
</div>
</div>
<p>Upon observation, it becomes apparent that the river dataset contains not only geometrical information, but also two additional columns for attribute data, namely ID and River_Name. Prior to visualizing the distribution of rivers across the country using ggplot2, it is imperative to ensure that the metadata of the imported dataset informs us on the spatial dimension.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> rivers) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-river2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-river2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Major rivers in Tanzania</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can also visualize the polgyon, for this case, i chopped the boundary of the Arusha region for illustration purpose. Let’s load the shapefile into our session using <code>st_read</code> function from <strong>sf</strong> package;</p>
<p>To visualize the polygon data, the boundary of the Arusha region was chopped for illustration purposes. This will allow us to better understand the shape of the polygon and its various components. The dataset can be loaded into the R session using the <code>st_read()</code> function from the sf package. plot</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>arusha <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/arusha_poly.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>arusha</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 1 feature and 1 field
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 34.70163 ymin: -4.083069 xmax: 37.31218 ymax: -1.708256
Geodetic CRS:  WGS 84
  region                           geom
1 ARUSHA MULTIPOLYGON (((37.31218 -2...</code></pre>
</div>
</div>
<p>The printed arusha dataset is a simple feature collection that comprises one feature and one field. The geometry type is multipolygon, with dimensions represented in XY format. The bounding box specifies the minimum and maximum values for the x and y coordinates, with xmin: 34.70163, ymin: -4.083069, xmax: 37.31218, and ymax: -1.708256 with a geodetic coordinate reference system (CRS) as WGS 84. The feature within this collection represents the region of Arusha, with its corresponding multipolygon geometry.</p>
<p>That information is key in understanding the spatial component in the dataset, and we can now proceed and plot this dataset with ggplot2 package.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> arusha) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>)<span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-4"><a href="#cb26-4"></a>    <span class="at">title =</span> <span class="st">"Arusha Region Boundary"</span>, </span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="at">subtitle =</span> <span class="st">"The location of Arusha Region"</span>, </span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="at">caption =</span> <span class="st">"Source: NBS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-poly" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-poly-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: The Arusha Region Boundary</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-raster-data" class="level3">
<h3 class="anchored" data-anchor-id="plotting-raster-data">Plotting Raster Data</h3>
<p>We can easily plot raster with <code>plot</code> function from terra package <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span>. We only need first to import our raster dataset from our working directory into R. As shown previous, that can be done using a <code>rast()</code> function also from terra, which read any type of raster dataset in R. Let’s import an elevation dataset using the chunk code belowp</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>elevation <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"data/elevation_arusha.tif"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>elevation </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 285, 313, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 34.7, 37.30833, -4.083333, -1.708333  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : elevation_arusha.tif 
name        : TZA_wc2.1_30s_elev 
min value   :                595 
max value   :               4222 </code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fl">0.008333333</span><span class="sc">*</span><span class="dv">110</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9166666</code></pre>
</div>
</div>
<p>The printed elevation dataset provides a comprehensive description of the SpatRaster class and its properties. The dataset indicates that is The SpatRaster class is a representation of a raster dataset with the following dimensions: 285 rows, 313 columns, and 1 layer. The spatial resolution of the dataset is 0.008333333 (~0.91km) in both x and y directions. The elevation of arusha presented in this dataset range from 595 to 4222 meters. Let’s plot the dataset</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>elevation <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-raster" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-raster-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: The elevation of Arusha</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>There are several ways to plot raster data in R, but <code>ggplot2</code> does not support raster data natively. But Diego Hernangómez -<span class="citation" data-cites="tidyterra">Hernangómez (<a href="#ref-tidyterra" role="doc-biblioref">2023</a>)</span> developed tidyverse package with function that support spatRaster in ggplot2. The code in the chunk below generates <a href="#fig-raster1">Figure&nbsp;6</a>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> elevation)<span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster_contour</span>(</span>
<span id="cb32-4"><a href="#cb32-4"></a>    <span class="at">data =</span> elevation, </span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="at">breaks =</span> <span class="dv">1800</span>, </span>
<span id="cb32-6"><a href="#cb32-6"></a>    <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-raster1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-raster1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: The elevation of Arusha</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="manipulating-spatial-data" class="level2">
<h2 class="anchored" data-anchor-id="manipulating-spatial-data">Manipulating Spatial Data</h2>
<p>To manipulate raster data, we can use functions such as <code>crop()</code>, <code>resample()</code>, and <code>mask()</code>. For example, to crop an elevation dataset of Tanzania to only cover the Arusha region, we can use the <code>crop()</code> function. Here is an example code:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="fu">library</span>(sf)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a>arusha <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/arusha_poly.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a>elevation <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"data/wc2.1_country/TZA_wc2.1_30s_elev.tif"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="sec-crop" class="level3">
<h3 class="anchored" data-anchor-id="sec-crop">Cropping raster</h3>
<p>Cropping a raster in R involves removing or extracting a subset of a raster based on a specified extent or boundary. The terra package <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span> in R provides a <code>crop()</code> function that can be used to crop a SpatRaster based on an extent object;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>arusha.elevation.crop <span class="ot">=</span> elevation <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2"></a>  terra<span class="sc">::</span><span class="fu">crop</span>(arusha)</span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a>arusha.elevation.crop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 285, 313, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 34.7, 37.30833, -4.083333, -1.708333  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
name        : TZA_wc2.1_30s_elev 
min value   :                595 
max value   :               4345 </code></pre>
</div>
</div>
<p>After cropping an elevation raster of the geographical extent of Tanzania to the Arusha region, the next step is to visualize the chopped elevation data. We can visualize it using ggplot2 <span class="citation" data-cites="ggplot">(<a href="#ref-ggplot" role="doc-biblioref">Wickham 2016</a>)</span> and tidyterra <span class="citation" data-cites="tidyterra">(<a href="#ref-tidyterra" role="doc-biblioref">Hernangómez 2023</a>)</span></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> arusha.elevation.crop)<span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb36-4"><a href="#cb36-4"></a>    <span class="at">data =</span> arusha, </span>
<span id="cb36-5"><a href="#cb36-5"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb36-6"><a href="#cb36-6"></a>    <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb36-7"><a href="#cb36-7"></a>    <span class="at">linewidth =</span> <span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-crop" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-crop-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;7: The cropped elevation within the geographical extent of Arusha Region</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-mask" class="level3">
<h3 class="anchored" data-anchor-id="sec-mask">Masking raster</h3>
<p>Masking a raster is a process of removing or replacing values in a raster based on a mask layer. A mask layer can be a raster or a polygon layer. The terra package <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span> in R provides a <code>mask()</code> function that can be used to mask values in a raster object based on values in another raster or polygon layer;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>arusha.elevation.mask <span class="ot">=</span> elevation <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  terra<span class="sc">::</span><span class="fu">crop</span>(arusha) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3"></a>  terra<span class="sc">::</span><span class="fu">mask</span>(arusha)</span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a>arusha.elevation.mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 285, 313, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 34.7, 37.30833, -4.083333, -1.708333  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
name        : TZA_wc2.1_30s_elev 
min value   :                595 
max value   :               4222 </code></pre>
</div>
</div>
<p>After masking an elevation raster of the geographical extent of Tanzania to the Arusha region, we can also visualize the masked elevation data using ggplot2 <span class="citation" data-cites="ggplot">(<a href="#ref-ggplot" role="doc-biblioref">Wickham 2016</a>)</span> and tidyterra <span class="citation" data-cites="tidyterra">(<a href="#ref-tidyterra" role="doc-biblioref">Hernangómez 2023</a>)</span></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> arusha.elevation.mask)<span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb39-4"><a href="#cb39-4"></a>    <span class="at">data =</span> arusha, </span>
<span id="cb39-5"><a href="#cb39-5"></a>    <span class="at">fill =</span> <span class="cn">NA</span>, </span>
<span id="cb39-6"><a href="#cb39-6"></a>    <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb39-7"><a href="#cb39-7"></a>    <span class="at">linewidth =</span> .<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sec-extract" class="level3">
<h3 class="anchored" data-anchor-id="sec-extract">Extracting elevation values</h3>
<p>The ability to extract values from a raster dataset at specific locations is a critical component of spatial analysis, modeling, and decision-making processes. Researchers and analysts can gain valuable insights into patterns, trends, and relationships within the dataset by obtaining values at specific locations. This information can be used to conduct point-based sampling for validation or modeling purposes, input for predictive models, and informed decision-making. By using this process, researchers and analysts can make informed decisions that are based on reliable data, leading to better outcomes and a more comprehensive understanding of the underlying data.</p>
<section id="extracting-from-single-raster-to-sampling-points" class="level4">
<h4 class="anchored" data-anchor-id="extracting-from-single-raster-to-sampling-points">Extracting from single raster to sampling points</h4>
<p>Let’s imagine we dataset representing the elevation of a Arusha region shown in <a href="#fig-arusha">Figure&nbsp;8</a>. This is in the form of a raster, where each pixel represents a small area on the map and has an associated elevation value. Now, we want to extract the elevation values of thirty specific locations (red sampling points) shown in <a href="#fig-arusha">Figure&nbsp;8</a> from this dataset.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_map_tile</span>(<span class="at">type =</span> <span class="st">"osm"</span>, <span class="at">zoom =</span> <span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> arusha.elevation.mask)<span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sampling.points, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tr"</span>)<span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">"bl"</span>)<span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb40-8"><a href="#cb40-8"></a>    <span class="at">colours =</span> <span class="fu">hcl.colors</span>(</span>
<span id="cb40-9"><a href="#cb40-9"></a>      <span class="at">n =</span> <span class="dv">20</span>, <span class="at">palette =</span> <span class="st">"Spectral"</span>) <span class="sc">%&gt;%</span> <span class="fu">rev</span>(), <span class="at">na.value =</span> <span class="cn">NA</span>,</span>
<span id="cb40-10"><a href="#cb40-10"></a>    <span class="at">guide =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> <span class="st">"Altitude (m)"</span>,</span>
<span id="cb40-11"><a href="#cb40-11"></a>                           <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb40-12"><a href="#cb40-12"></a>                           <span class="at">direction =</span> <span class="st">"horizontal"</span>, </span>
<span id="cb40-13"><a href="#cb40-13"></a>                           <span class="at">barheight =</span> .<span class="dv">6</span> )</span>
<span id="cb40-14"><a href="#cb40-14"></a>    )<span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16"></a>  <span class="fu">theme</span>(</span>
<span id="cb40-17"><a href="#cb40-17"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">840</span>,.<span class="dv">08</span>), </span>
<span id="cb40-18"><a href="#cb40-18"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb40-19"><a href="#cb40-19"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-arusha" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-arusha-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8: The sampling points superimposed on elevation dataset for Arusha Region, Tanzania</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>First, we load the terra package <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span> along with sf <span class="citation" data-cites="sf">(<a href="#ref-sf" role="doc-biblioref">Pebesma 2018</a>)</span> and tidyverse <span class="citation" data-cites="tidyverse">(<a href="#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span>, which provides functions for working with raster data and vector data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">require</span>(terra)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="fu">require</span>(sf)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="fu">require</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, we read the raster dataset into R using the rast function.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>arusha.elevation <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"data/elevation_arusha.tif"</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>arusha.elevation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 285, 313, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 34.7, 37.30833, -4.083333, -1.708333  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : elevation_arusha.tif 
name        : TZA_wc2.1_30s_elev 
min value   :                595 
max value   :               4222 </code></pre>
</div>
</div>
<p>Next, we import the sampling points, which are simple feature of the thirty locations we are interested in.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>sampling.points <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/sampling_points.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>sampling.points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 30 features and 1 field
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 35.08742 ymin: -3.915823 xmax: 36.95439 ymax: -1.800931
Geodetic CRS:  WGS 84
First 10 features:
         name                       geom
1   station_1     POINT (36.853 -3.4023)
2   station_2  POINT (36.6334 -3.017127)
3   station_3   POINT (35.47925 -2.4742)
4   station_4 POINT (35.12118 -3.674647)
5   station_5  POINT (36.7901 -2.687773)
6   station_6 POINT (36.95439 -2.939174)
7   station_7 POINT (36.34118 -2.651372)
8   station_8 POINT (36.38371 -3.915823)
9   station_9 POINT (35.60775 -2.240748)
10 station_10 POINT (35.46656 -1.909838)</code></pre>
</div>
</div>
<p>With the sampling points loaded, we use the <code>extract</code> function from the terra package to extract the elevation values at those specific points from the raster dataset. This function retrieves the elevation values corresponding to the locations we specified.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>elevation.tb <span class="ot">=</span> arusha.elevation <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2"></a>  terra<span class="sc">::</span><span class="fu">extract</span>(sampling.points) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">atitude_m =</span> TZA_wc2<span class="fl">.1</span>_30s_elev)</span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a>elevation.tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   atitude_m
1       1102
2       1407
3       1844
4       1027
5       1354
6       1200
7       1175
8       1581
9       1836
10      2133
11      1249
12      1672
13      1765
14      1215
15      1489
16      1027
17      1027
18      1016
19      3358
20      1170
21      2032
22      1262
23       603
24      1150
25      1363
26      2162
27      1137
28      1056
29      1722
30      1459</code></pre>
</div>
</div>
<p>We can then combine the sampling points simple feature with the extracted ones;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>sampling.points.tb <span class="ot">=</span> sampling.points <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(elevation.tb)</span>
<span id="cb48-3"><a href="#cb48-3"></a></span>
<span id="cb48-4"><a href="#cb48-4"></a>sampling.points.tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 30 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 35.08742 ymin: -3.915823 xmax: 36.95439 ymax: -1.800931
Geodetic CRS:  WGS 84
First 10 features:
         name atitude_m                       geom
1   station_1      1102     POINT (36.853 -3.4023)
2   station_2      1407  POINT (36.6334 -3.017127)
3   station_3      1844   POINT (35.47925 -2.4742)
4   station_4      1027 POINT (35.12118 -3.674647)
5   station_5      1354  POINT (36.7901 -2.687773)
6   station_6      1200 POINT (36.95439 -2.939174)
7   station_7      1175 POINT (36.34118 -2.651372)
8   station_8      1581 POINT (36.38371 -3.915823)
9   station_9      1836 POINT (35.60775 -2.240748)
10 station_10      2133 POINT (35.46656 -1.909838)</code></pre>
</div>
</div>
</section>
<section id="extracting-from-single-raster-to-polygon" class="level4">
<h4 class="anchored" data-anchor-id="extracting-from-single-raster-to-polygon">Extracting from single raster to polygon</h4>
<p>This <code>extract()</code> function from terra packages is not limited to extracts the values of a raster at the locations of spatial point, but it may be used to extract values of raster from spatial vector data of lines, and polygons. Let’s see how to extract the elevation values for each ward in the Arusha region. Let’s import the ward dataset from our working directory</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>wards<span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/arusha_wards.gpkg"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a>wards </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 155 features and 8 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 34.74975 ymin: -4.150178 xmax: 37.4302 ymax: -1.689487
Geodetic CRS:  WGS 84
First 10 features:
   Region_Nam   District_N Ward_Code    Ward_Name Ward_ID Council_Na  Division
1      Arusha Arusha Rural       011 Oldonyosambu  100068  Arusha DC   Mukulat
2      Arusha Arusha Rural       011   Oldonyowas  100069  Arusha DC   Mukulat
3      Arusha Arusha Rural       021    Lemanyata  100067  Arusha DC   Mukulat
4      Arusha Arusha Rural       031   Ilkiding'a  100077  Arusha DC Enaboishu
5      Arusha Arusha Rural       041      Bangata  100079  Arusha DC   Moshono
6      Arusha Arusha Rural       053        Kiutu  100081  Arusha DC   Moshono
7      Arusha Arusha Rural       053     Sokon II  100080  Arusha DC   Moshono
8      Arusha Arusha Rural       061     Olturoto  100078  Arusha DC Enaboishu
9      Arusha Arusha Rural       073       Ilboru  100091  Arusha DC Enaboishu
10     Arusha Arusha Rural       073        Moivo  100089  Arusha DC Enaboishu
   Population                           geom
1       16484 MULTIPOLYGON (((36.68804 -3...
2       16484 MULTIPOLYGON (((36.742 -3.0...
3           0 MULTIPOLYGON (((36.64091 -3...
4       10850 MULTIPOLYGON (((36.73854 -3...
5        9136 MULTIPOLYGON (((36.75432 -3...
6       32073 MULTIPOLYGON (((36.72413 -3...
7       32073 MULTIPOLYGON (((36.7456 -3....
8       15451 MULTIPOLYGON (((36.71474 -3...
9       27151 MULTIPOLYGON (((36.68481 -3...
10      27151 MULTIPOLYGON (((36.69487 -3...</code></pre>
</div>
</div>
<p>The printed output indicates that the dataset has 155 features representing wards in the Arusha. Unlike extracting raster to point feature, for polygone, we need to parse more argument to tell the function that it has to calculate the mean of all the cells within its polygon;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>ward.elevation <span class="ot">=</span> arusha.elevation <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  terra<span class="sc">::</span><span class="fu">extract</span>(<span class="at">y =</span> wards, <span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">method =</span> <span class="st">"simple"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">elevation_m =</span> TZA_wc2<span class="fl">.1</span>_30s_elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then we bind the ward elevation into simple feature</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>wards.elevation.sf <span class="ot">=</span> wards <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">bind_cols</span>(ward.elevation)</span>
<span id="cb53-3"><a href="#cb53-3"></a></span>
<span id="cb53-4"><a href="#cb53-4"></a>wards.elevation.sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 155 features and 9 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 34.74975 ymin: -4.150178 xmax: 37.4302 ymax: -1.689487
Geodetic CRS:  WGS 84
First 10 features:
   Region_Nam   District_N Ward_Code    Ward_Name Ward_ID Council_Na  Division
1      Arusha Arusha Rural       011 Oldonyosambu  100068  Arusha DC   Mukulat
2      Arusha Arusha Rural       011   Oldonyowas  100069  Arusha DC   Mukulat
3      Arusha Arusha Rural       021    Lemanyata  100067  Arusha DC   Mukulat
4      Arusha Arusha Rural       031   Ilkiding'a  100077  Arusha DC Enaboishu
5      Arusha Arusha Rural       041      Bangata  100079  Arusha DC   Moshono
6      Arusha Arusha Rural       053        Kiutu  100081  Arusha DC   Moshono
7      Arusha Arusha Rural       053     Sokon II  100080  Arusha DC   Moshono
8      Arusha Arusha Rural       061     Olturoto  100078  Arusha DC Enaboishu
9      Arusha Arusha Rural       073       Ilboru  100091  Arusha DC Enaboishu
10     Arusha Arusha Rural       073        Moivo  100089  Arusha DC Enaboishu
   Population elevation_m                           geom
1       16484    1814.672 MULTIPOLYGON (((36.68804 -3...
2       16484    1600.916 MULTIPOLYGON (((36.742 -3.0...
3           0    1829.227 MULTIPOLYGON (((36.64091 -3...
4       10850    2805.412 MULTIPOLYGON (((36.73854 -3...
5        9136    1823.938 MULTIPOLYGON (((36.75432 -3...
6       32073    1636.500 MULTIPOLYGON (((36.72413 -3...
7       32073    1628.917 MULTIPOLYGON (((36.7456 -3....
8       15451    1647.100 MULTIPOLYGON (((36.71474 -3...
9       27151    1457.000 MULTIPOLYGON (((36.68481 -3...
10      27151    1482.750 MULTIPOLYGON (((36.69487 -3...</code></pre>
</div>
</div>
<p>And map the spatial distribution of the elevation across the region</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> wards.elevation.sf, </span>
<span id="cb55-3"><a href="#cb55-3"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> elevation_m), </span>
<span id="cb55-4"><a href="#cb55-4"></a>          <span class="at">color =</span> <span class="st">"ivory"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="extracting-from-multiple-raster-to-sampling-points" class="level4">
<h4 class="anchored" data-anchor-id="extracting-from-multiple-raster-to-sampling-points">Extracting from multiple raster to sampling points</h4>
</section>
</section>
</section>
<section id="temperature" class="level2">
<h2 class="anchored" data-anchor-id="temperature">Temperature</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>temperature <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"data/wc2.1_country/TZA_wc2.1_30s_tmax.tif"</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>temperature</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 1380, 1380, 12  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 29, 40.5, -12, -0.5  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : TZA_wc2.1_30s_tmax.tif 
names       : TZA_w~max_1, TZA_w~max_2, TZA_w~max_3, TZA_w~max_4, TZA_w~max_5, TZA_w~max_6, ... 
min values  :         2.9,         4.1,         3.7,         2.1,         1.0,         1.4, ... 
max values  :        34.8,        36.0,        36.2,        34.7,        33.5,        33.5, ... </code></pre>
</div>
</div>
<p>The displayed raster indicates that the temperature dataset consists of twelve layers, each representing a different month from January to December. The spatial extent covers the entire country with a spatial resolution of approximately 0.0083, equivalent to around 900 meters. However, the names assigned to the months are disorganized and challenging to interpret.</p>
<p>To address this, it is necessary to enhance the dataset by assigning appropriate names to each month and performing cropping (describe in <a href="#sec-crop">Section&nbsp;3.5.1</a>) and masking (describe in <a href="#sec-mask">Section&nbsp;3.5.2</a>) operations to limit the temperature raster to the boundaries of the Arusha region. The chunk below highlight the procedure for renaming months, crop and mask the temperature layer.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>temperature <span class="ot">=</span> temperature <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2"></a>  tidyterra<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Jan =</span> <span class="dv">1</span>, <span class="at">Feb =</span> <span class="dv">2</span>, <span class="at">Mar =</span> <span class="dv">3</span>, <span class="at">Apr =</span> <span class="dv">4</span>, </span>
<span id="cb58-3"><a href="#cb58-3"></a>                    <span class="at">May =</span> <span class="dv">5</span>, <span class="at">Jun =</span> <span class="dv">6</span>,   <span class="at">Jul =</span> <span class="dv">7</span>, <span class="at">Aug =</span> <span class="dv">8</span>, </span>
<span id="cb58-4"><a href="#cb58-4"></a>                    <span class="at">Sep =</span> <span class="dv">9</span>, <span class="at">Oct =</span> <span class="dv">10</span>, <span class="at">Nov =</span> <span class="dv">11</span>, <span class="at">Dec =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-5"><a href="#cb58-5"></a>  terra<span class="sc">::</span><span class="fu">crop</span>(arusha) <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="#cb58-6"></a>  terra<span class="sc">::</span><span class="fu">mask</span>(arusha)</span>
<span id="cb58-7"><a href="#cb58-7"></a></span>
<span id="cb58-8"><a href="#cb58-8"></a>temperature</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 285, 313, 12  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 34.7, 37.30833, -4.083333, -1.708333  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
names       : Jan,  Feb,  Mar,  Apr,  May,  Jun, ... 
min values  :  10, 10.9, 10.5,  8.6,  6.8,  6.5, ... 
max values  :  34, 34.4, 34.0, 32.7, 31.2, 30.2, ... </code></pre>
</div>
</div>
<p>The cleaned temperature raster consists of twelve layers, but with more describtive layer name, each representing a different month from January to December. Unlike the origin, the cleaned raster dataseted now has a spatial extent only cover the Arusha region but retain a spatial resolution of approximately 0.0083, equivalent to around 900 meters. Let’splot this temperature layer using <code>plot</code> function;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>temperature <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-temp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-temp-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;9: Monthly temperature variation across the Arusha Region</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We notice that maximum temperature at Arusha vary across the region and we want to extract monthly value to the thirty sampling points</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data =</span> temperature)<span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sampling.points, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lyr)<span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>  <span class="fu">scale_fill_gradientn</span>(</span>
<span id="cb61-6"><a href="#cb61-6"></a>    <span class="at">name =</span> <span class="st">"Tmax"</span>,</span>
<span id="cb61-7"><a href="#cb61-7"></a>    <span class="at">colours =</span> <span class="fu">hcl.colors</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">palette =</span> <span class="st">"Temps"</span>), </span>
<span id="cb61-8"><a href="#cb61-8"></a>    <span class="at">na.value =</span> <span class="cn">NA</span>, </span>
<span id="cb61-9"><a href="#cb61-9"></a>    <span class="at">trans =</span> scales<span class="sc">::</span><span class="fu">modulus_trans</span>(<span class="at">p =</span> <span class="dv">4</span>), </span>
<span id="cb61-10"><a href="#cb61-10"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">29</span>, <span class="dv">31</span>, <span class="dv">33</span>))<span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">35.5</span>,<span class="dv">37</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-temp2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-temp2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;10: Sampling points overlaid on temperature variation across the Arusha Region</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Though we have a spatraster with twelve layer, we are not going to extract values to the sampling points manual for each month but rather leveraging the capabilities of terra, without the need for complex and time-consuming manual processes.</p>
<p>As outlined in <a href="#sec-extract">Section&nbsp;3.5.3</a>, the <code>extract</code> function in Terra <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span> can be utilized to extract raster values from a stacked spatraster object. This technique is highly effective and allows for the extraction of temperature data at a monthly level, which can be further analyzed and utilized for various scientific or research purposes. This approach is particularly useful in scenarios where large datasets need to be processed quickly and accurately.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-45"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-45-1" class="code-annotation-target"><a href="#annotated-cell-45-1"></a>temperatur.tb <span class="ot">=</span> temperature <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-45-2" class="code-annotation-target"><a href="#annotated-cell-45-2"></a>  terra<span class="sc">::</span><span class="fu">extract</span>(sampling.points, <span class="at">xy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-45-3" class="code-annotation-target"><a href="#annotated-cell-45-3"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(x,y), <span class="at">.before =</span> ID) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-45-4" class="code-annotation-target"><a href="#annotated-cell-45-4"></a>  <span class="fu">rename</span>(<span class="at">lon =</span> x, <span class="at">lat =</span> y)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-45" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="1" data-code-annotation="1">extract temperature with corresponding xy</span>
</dd>
<dt data-target-cell="annotated-cell-45" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="2" data-code-annotation="2">extract value of raster to sampling points</span>
</dd>
<dt data-target-cell="annotated-cell-45" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="3" data-code-annotation="3">change the position of x and y</span>
</dd>
<dt data-target-cell="annotated-cell-45" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-45" data-code-lines="4" data-code-annotation="4">rename x to lon and y to lat</span>
</dd>
</dl>
</div>
</div>
<p>The monthly temperature value for each sampling location with corresponding longitude and latitude are presented in the <a href="#tbl-temperature">Table&nbsp;1</a>;</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-temperature" class="anchored">

<div id="ioyryzkzgf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ioyryzkzgf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ioyryzkzgf thead, #ioyryzkzgf tbody, #ioyryzkzgf tfoot, #ioyryzkzgf tr, #ioyryzkzgf td, #ioyryzkzgf th {
  border-style: none;
}

#ioyryzkzgf p {
  margin: 0;
  padding: 0;
}

#ioyryzkzgf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ioyryzkzgf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ioyryzkzgf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ioyryzkzgf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ioyryzkzgf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ioyryzkzgf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ioyryzkzgf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ioyryzkzgf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ioyryzkzgf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ioyryzkzgf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ioyryzkzgf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ioyryzkzgf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ioyryzkzgf .gt_spanner_row {
  border-bottom-style: hidden;
}

#ioyryzkzgf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ioyryzkzgf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ioyryzkzgf .gt_from_md > :first-child {
  margin-top: 0;
}

#ioyryzkzgf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ioyryzkzgf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ioyryzkzgf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ioyryzkzgf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ioyryzkzgf .gt_row_group_first td {
  border-top-width: 2px;
}

#ioyryzkzgf .gt_row_group_first th {
  border-top-width: 2px;
}

#ioyryzkzgf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ioyryzkzgf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ioyryzkzgf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ioyryzkzgf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ioyryzkzgf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ioyryzkzgf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ioyryzkzgf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ioyryzkzgf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ioyryzkzgf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ioyryzkzgf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ioyryzkzgf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ioyryzkzgf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ioyryzkzgf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ioyryzkzgf .gt_left {
  text-align: left;
}

#ioyryzkzgf .gt_center {
  text-align: center;
}

#ioyryzkzgf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ioyryzkzgf .gt_font_normal {
  font-weight: normal;
}

#ioyryzkzgf .gt_font_bold {
  font-weight: bold;
}

#ioyryzkzgf .gt_font_italic {
  font-style: italic;
}

#ioyryzkzgf .gt_super {
  font-size: 65%;
}

#ioyryzkzgf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ioyryzkzgf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ioyryzkzgf .gt_indent_1 {
  text-indent: 5px;
}

#ioyryzkzgf .gt_indent_2 {
  text-indent: 10px;
}

#ioyryzkzgf .gt_indent_3 {
  text-indent: 15px;
}

#ioyryzkzgf .gt_indent_4 {
  text-indent: 20px;
}

#ioyryzkzgf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;1:  <p>Monthly temperature arranged in wide form color coded to show the
magnitude and intensity</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="LON">LON</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="LAT">LAT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="JAN">JAN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="FEB">FEB</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="MAR">MAR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="APR">APR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="MAY">MAY</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="JUN">JUN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="JUL">JUL</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AUG">AUG</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SEP">SEP</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="OCT">OCT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="NOV">NOV</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="DEC">DEC</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.9</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.4</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">1</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #007EA4; color: #FFFFFF;">29.8</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #DBC863; color: #000000;">30.3</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #01ADB6; color: #FFFFFF;">29.4</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #82BB48; color: #000000;">26.7</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7940E; color: #000000;">24.4</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #A4D485; color: #000000;">23.4</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #7DB5D4; color: #000000;">22.9</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #9C97C0; color: #FFFFFF;">23.9</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D9A88E; color: #000000;">26.1</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D9A167; color: #000000;">27.9</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #A4AE63; color: #000000;">28.5</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #66A89E; color: #FFFFFF;">29.0</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.6</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.0</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">2</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0192A7; color: #FFFFFF;">29.0</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #CDBC6A; color: #000000;">29.4</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #08BCB4; color: #000000;">28.7</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #89BE4A; color: #000000;">26.5</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7900A; color: #000000;">24.7</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #8FC666; color: #000000;">24.2</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #66ACCF; color: #000000;">23.3</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #948EBB; color: #FFFFFF;">24.2</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D9A58C; color: #000000;">26.3</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #DAA46B; color: #000000;">27.7</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #B3BC7C; color: #000000;">27.4</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #8BB5A4; color: #000000;">27.6</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.5</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.5</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">3</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #B4E4C2; color: #000000;">24.6</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #8B887B; color: #FFFFFF;">25.1</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #DCF7B4; color: #000000;">24.9</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #EEF4A7; color: #000000;">23.0</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EABF23; color: #000000;">21.1</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #D7F1C8; color: #000000;">21.3</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #C9DDEB; color: #000000;">21.0</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #CAC8DB; color: #000000;">22.1</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #E1C9AB; color: #000000;">23.8</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #EBD3A2; color: #000000;">24.9</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #E2E8C0; color: #000000;">24.2</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #DAE0C3; color: #000000;">23.6</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.1</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">4</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0176A3; color: #FFFFFF;">30.1</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #DAC764; color: #000000;">30.2</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #01A3B6; color: #FFFFFF;">29.8</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #418F3B; color: #FFFFFF;">28.9</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E97300; color: #FFFFFF;">26.5</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #6AAB22; color: #FFFFFF;">25.5</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #1491C0; color: #FFFFFF;">24.4</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #6C63A8; color: #FFFFFF;">25.6</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D79180; color: #FFFFFF;">27.6</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D3894E; color: #FFFFFF;">29.2</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #949E47; color: #FFFFFF;">29.7</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #58A39E; color: #FFFFFF;">29.5</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.8</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">5</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #01A2A9; color: #FFFFFF;">28.3</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #C7B76D; color: #000000;">29.0</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #27C3B2; color: #000000;">28.3</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #95C650; color: #000000;">26.1</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7940E; color: #000000;">24.4</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #9FD17D; color: #000000;">23.6</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #7DB5D4; color: #000000;">22.9</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #A39FC4; color: #FFFFFF;">23.6</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #DAAD91; color: #000000;">25.8</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #DBA971; color: #000000;">27.4</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #B9C285; color: #000000;">27.0</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #97BAA8; color: #000000;">27.1</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">37.0</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.9</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">6</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #007BA4; color: #FFFFFF;">29.9</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #DBC863; color: #000000;">30.3</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #01AFB5; color: #FFFFFF;">29.3</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #7AB546; color: #000000;">27.0</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E78501; color: #FFFFFF;">25.4</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #89C25D; color: #000000;">24.4</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #51A5CB; color: #FFFFFF;">23.6</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #8E88B8; color: #FFFFFF;">24.4</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D8A089; color: #000000;">26.6</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D89D63; color: #000000;">28.1</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #ABB56E; color: #000000;">28.0</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #6EAB9F; color: #FFFFFF;">28.7</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.3</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">7</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0186A5; color: #FFFFFF;">29.5</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #D7C466; color: #000000;">30.0</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #00A8B6; color: #FFFFFF;">29.6</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #68A943; color: #FFFFFF;">27.6</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E87B00; color: #FFFFFF;">26.0</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #6CAE25; color: #FFFFFF;">25.4</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #008ABC; color: #FFFFFF;">24.7</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #7169AB; color: #FFFFFF;">25.4</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D79481; color: #000000;">27.4</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D59258; color: #FFFFFF;">28.7</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #A8B26A; color: #000000;">28.2</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #78AEA1; color: #000000;">28.3</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.4</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.9</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">8</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #5AC1B0; color: #000000;">26.7</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #A89F75; color: #FFFFFF;">27.0</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #9EE6AD; color: #000000;">26.3</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #C4DE7B; color: #000000;">24.6</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E9B01D; color: #000000;">22.3</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #C7E9B3; color: #000000;">22.0</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #C3D9E9; color: #000000;">21.2</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #C3C1D7; color: #000000;">22.4</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #DEBEA0; color: #000000;">24.6</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #E2BC86; color: #000000;">26.3</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #C3CB94; color: #000000;">26.3</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #AFC3B3; color: #000000;">26.1</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.6</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.2</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">9</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #B1E2C1; color: #000000;">24.7</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #8E8A7B; color: #FFFFFF;">25.3</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #D4F5B2; color: #000000;">25.1</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #EBF3A4; color: #000000;">23.1</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EAC024; color: #000000;">21.0</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #D5F0C5; color: #000000;">21.4</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #C3D9E9; color: #000000;">21.2</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #C5C3D8; color: #000000;">22.3</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #E0C7A9; color: #000000;">23.9</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #EBD3A2; color: #000000;">24.9</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #E0E6BE; color: #000000;">24.3</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #D8DFC3; color: #000000;">23.7</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.5</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−1.9</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">10</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #CEF0C1; color: #000000;">23.4</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #7A7B7B; color: #FFFFFF;">24.0</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #F5FCBA; color: #000000;">24.2</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #FAFAB6; color: #000000;">22.3</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EAC527; color: #000000;">20.6</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #DDF3D0; color: #000000;">21.0</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #C3D9E9; color: #000000;">21.2</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #D2D0E0; color: #000000;">21.8</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #E4D2B4; color: #000000;">23.1</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #F1E2B3; color: #000000;">24.0</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #EBF0CE; color: #000000;">23.6</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #E7E7C1; color: #000000;">22.8</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.7</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.8</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">11</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #007EA4; color: #FFFFFF;">29.8</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #DAC764; color: #000000;">30.2</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #01ADB6; color: #FFFFFF;">29.4</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #71AF44; color: #FFFFFF;">27.3</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E78000; color: #FFFFFF;">25.7</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #7DBA4B; color: #000000;">24.8</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #319BC6; color: #FFFFFF;">24.0</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #837CB3; color: #FFFFFF;">24.8</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D89A85; color: #000000;">27.0</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D6965B; color: #000000;">28.5</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #A8B26A; color: #000000;">28.2</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #73ADA0; color: #FFFFFF;">28.5</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.1</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.1</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">12</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #64C5B1; color: #000000;">26.5</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #A89F75; color: #FFFFFF;">27.0</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #8EE2AD; color: #000000;">26.6</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #A6CE5E; color: #000000;">25.6</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E89A13; color: #000000;">23.9</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #92C86A; color: #000000;">24.1</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #60AACE; color: #FFFFFF;">23.4</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #8E88B8; color: #FFFFFF;">24.4</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D9AA8F; color: #000000;">26.0</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #DDB079; color: #000000;">27.0</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #C2CA91; color: #000000;">26.4</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #BECABC; color: #000000;">25.4</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.6</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.3</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">13</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #A2DDBC; color: #000000;">25.1</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #948F7A; color: #FFFFFF;">25.7</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #C2F0AF; color: #000000;">25.5</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #E2EE99; color: #000000;">23.5</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EABB22; color: #000000;">21.4</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #CCEBBA; color: #000000;">21.8</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #B5D1E4; color: #000000;">21.6</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #BEBBD4; color: #000000;">22.6</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #DFC2A4; color: #000000;">24.3</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #E8CD9A; color: #000000;">25.3</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #DAE1B6; color: #000000;">24.7</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #D1DAC2; color: #000000;">24.1</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.2</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">14</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0194A7; color: #FFFFFF;">28.9</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #CABA6B; color: #000000;">29.2</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #0BC0B3; color: #000000;">28.5</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #7DB746; color: #000000;">26.9</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7920D; color: #000000;">24.5</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #94CA6E; color: #000000;">24.0</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #60AACE; color: #FFFFFF;">23.4</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #8982B6; color: #FFFFFF;">24.6</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D89A85; color: #000000;">27.0</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D6965B; color: #000000;">28.5</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #A2AB5F; color: #000000;">28.7</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #73ADA0; color: #FFFFFF;">28.5</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.6</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.9</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">15</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #1AAFAB; color: #FFFFFF;">27.7</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #B9AC72; color: #000000;">28.1</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #59D1B0; color: #000000;">27.6</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #B0D367; color: #000000;">25.3</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E8A218; color: #000000;">23.3</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #B4DE9A; color: #000000;">22.8</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #A2C7DF; color: #000000;">22.1</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #B3B0CE; color: #000000;">23.0</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #DCB799; color: #000000;">25.1</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #DFB57F; color: #000000;">26.7</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #BFC78D; color: #000000;">26.6</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #A6C0AE; color: #000000;">26.5</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.1</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.6</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">16</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0194A7; color: #FFFFFF;">28.9</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #C5B66D; color: #000000;">28.9</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #06BAB4; color: #000000;">28.8</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #5FA342; color: #FFFFFF;">27.9</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E78200; color: #FFFFFF;">25.6</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #7DBA4B; color: #000000;">24.8</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #49A2CA; color: #FFFFFF;">23.7</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #8079B1; color: #FFFFFF;">24.9</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D89A85; color: #000000;">27.0</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D59156; color: #FFFFFF;">28.8</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #9AA452; color: #FFFFFF;">29.2</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #6EAB9F; color: #FFFFFF;">28.7</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.2</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.5</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">17</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0099A8; color: #FFFFFF;">28.7</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #C2B46F; color: #000000;">28.7</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #09BEB3; color: #000000;">28.6</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #62A542; color: #FFFFFF;">27.8</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E78603; color: #FFFFFF;">25.3</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #89C25D; color: #000000;">24.4</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #66ACCF; color: #000000;">23.3</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #8B85B7; color: #FFFFFF;">24.5</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D8A089; color: #000000;">26.6</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D6985D; color: #000000;">28.4</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #9DA757; color: #FFFFFF;">29.0</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #6EAB9F; color: #FFFFFF;">28.7</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.3</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">18</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0254A0; color: #FFFFFF;">31.3</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #F3DC51; color: #000000;">31.8</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #2277B0; color: #FFFFFF;">31.4</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #338739; color: #FFFFFF;">29.3</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EC5800; color: #FFFFFF;">27.8</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #4A8001; color: #FFFFFF;">27.2</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #00578B; color: #FFFFFF;">26.5</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #3F337B; color: #FFFFFF;">27.2</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D47379; color: #FFFFFF;">29.3</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #CE703A; color: #FFFFFF;">30.5</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #8F9940; color: #FFFFFF;">30.1</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #489C9E; color: #FFFFFF;">30.1</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.8</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.3</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">19</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #7D0112; color: #FFFFFF;">14.7</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #00214E; color: #FFFFFF;">15.5</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #A71B4B; color: #FFFFFF;">15.2</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #A51122; color: #FFFFFF;">13.2</td>
<td headers="May" class="gt_row gt_right" style="background-color: #3B99B1; color: #FFFFFF;">11.0</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #90005D; color: #FFFFFF;">10.5</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #611300; color: #FFFFFF;">9.8</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #743700; color: #FFFFFF;">10.8</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #009593; color: #FFFFFF;">12.4</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #3C5941; color: #FFFFFF;">14.1</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #D66982; color: #FFFFFF;">13.7</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #A36B2B; color: #FFFFFF;">13.6</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.8</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.4</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">20</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #009DA9; color: #FFFFFF;">28.5</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #C7B76D; color: #000000;">29.0</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #0BC0B3; color: #000000;">28.5</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #7AB546; color: #000000;">27.0</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7920D; color: #000000;">24.5</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #94CA6E; color: #000000;">24.0</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #72B1D2; color: #000000;">23.1</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #918BBA; color: #FFFFFF;">24.3</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D8A28A; color: #000000;">26.5</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D9A167; color: #000000;">27.9</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #ACB670; color: #000000;">27.9</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #88B4A4; color: #000000;">27.7</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.5</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−1.8</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">21</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #C2E8C7; color: #000000;">24.2</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #83827C; color: #FFFFFF;">24.6</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #DCF7B4; color: #000000;">24.9</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #E9F1A2; color: #000000;">23.2</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EABB22; color: #000000;">21.4</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #D1EEC0; color: #000000;">21.6</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #B9D3E6; color: #000000;">21.5</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #C8C6DA; color: #000000;">22.2</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #E3CEB0; color: #000000;">23.4</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #EDDAAA; color: #000000;">24.5</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #E3E9C3; color: #000000;">24.1</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #DEE3C3; color: #000000;">23.4</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.6</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">22</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0190A7; color: #FFFFFF;">29.1</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #D0BF68; color: #000000;">29.6</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #08BCB4; color: #000000;">28.7</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #86BC49; color: #000000;">26.6</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7940E; color: #000000;">24.4</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #9ACD76; color: #000000;">23.8</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #60AACE; color: #FFFFFF;">23.4</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #8E88B8; color: #FFFFFF;">24.4</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D8A089; color: #000000;">26.6</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D79B61; color: #000000;">28.2</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #A8B26A; color: #000000;">28.2</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #76AEA0; color: #000000;">28.4</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.1</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.5</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">23</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #1F28A2; color: #FFFFFF;">32.3</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #FFE93F; color: #000000;">32.8</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #584B9F; color: #FFFFFF;">32.7</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #006228; color: #FFFFFF;">31.1</td>
<td headers="May" class="gt_row gt_right" style="background-color: #F5191C; color: #FFFFFF;">29.3</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #315D00; color: #FFFFFF;">28.5</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #003560; color: #FFFFFF;">27.6</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #1C0D51; color: #FFFFFF;">28.5</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D35C79; color: #FFFFFF;">30.4</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #C7522B; color: #FFFFFF;">31.9</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #798233; color: #FFFFFF;">31.8</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #2686A0; color: #FFFFFF;">31.8</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.3</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">24</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0181A5; color: #FFFFFF;">29.7</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #DAC764; color: #000000;">30.2</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #01A3B6; color: #FFFFFF;">29.8</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #62A542; color: #FFFFFF;">27.8</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E87800; color: #FFFFFF;">26.2</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #68A91F; color: #FFFFFF;">25.6</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #0087BA; color: #FFFFFF;">24.8</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #6C63A8; color: #FFFFFF;">25.6</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D79180; color: #FFFFFF;">27.6</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D58F54; color: #FFFFFF;">28.9</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #A6AF65; color: #000000;">28.4</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #73ADA0; color: #FFFFFF;">28.5</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.6</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.7</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">25</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0099A8; color: #FFFFFF;">28.7</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #CABA6B; color: #000000;">29.2</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #08BCB4; color: #000000;">28.7</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #8CC04B; color: #000000;">26.4</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7900A; color: #000000;">24.7</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #97CC72; color: #000000;">23.9</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #6CAED0; color: #000000;">23.2</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #9994BE; color: #FFFFFF;">24.0</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D9A78D; color: #000000;">26.2</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #DAA46B; color: #000000;">27.7</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #B5BE7E; color: #000000;">27.3</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #8EB6A5; color: #000000;">27.5</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.7</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.3</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">26</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #CDE79D; color: #000000;">22.2</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #6A6D76; color: #FFFFFF;">22.8</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #FCDE85; color: #000000;">22.2</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #F6DA8A; color: #000000;">20.2</td>
<td headers="May" class="gt_row gt_right" style="background-color: #A8C293; color: #000000;">17.6</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #F6CCDE; color: #000000;">16.9</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #EDBBB4; color: #000000;">16.1</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #FFCDA3; color: #000000;">17.3</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #C6D2B7; color: #000000;">19.1</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #CBCEA2; color: #000000;">21.0</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #F9D3DA; color: #000000;">21.1</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #DFD4A6; color: #000000;">21.1</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.7</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.5</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">27</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0173A3; color: #FFFFFF;">30.2</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #E3CF5E; color: #000000;">30.8</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #0193B5; color: #FFFFFF;">30.4</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #47943D; color: #FFFFFF;">28.7</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EB6300; color: #FFFFFF;">27.3</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #4E8503; color: #FFFFFF;">27.0</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #006197; color: #FFFFFF;">26.2</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #42367F; color: #FFFFFF;">27.1</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D47779; color: #FFFFFF;">29.1</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #CF783F; color: #FFFFFF;">30.1</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #98A24E; color: #FFFFFF;">29.4</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #63A79E; color: #FFFFFF;">29.1</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.2</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.5</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">28</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #0169A2; color: #FFFFFF;">30.6</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #E8D35B; color: #000000;">31.1</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #018BB4; color: #FFFFFF;">30.7</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #44913C; color: #FFFFFF;">28.8</td>
<td headers="May" class="gt_row gt_right" style="background-color: #EB6300; color: #FFFFFF;">27.3</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #569008; color: #FFFFFF;">26.6</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #006EA9; color: #FFFFFF;">25.8</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #534795; color: #FFFFFF;">26.5</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #D5827A; color: #FFFFFF;">28.5</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #D07E44; color: #FFFFFF;">29.8</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #9AA452; color: #FFFFFF;">29.2</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #5AA49E; color: #FFFFFF;">29.4</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">35.2</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−3.2</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">29</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #7CCEB4; color: #000000;">26.0</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #A19A77; color: #FFFFFF;">26.6</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #ACEAAD; color: #000000;">26.0</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #BCD972; color: #000000;">24.9</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E8A61A; color: #000000;">23.0</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #AAD78C; color: #000000;">23.2</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #87BAD7; color: #000000;">22.7</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #9E9AC1; color: #FFFFFF;">23.8</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #DBB295; color: #000000;">25.4</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #E2BC86; color: #000000;">26.3</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #CFD6A4; color: #000000;">25.5</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #C8D2C1; color: #000000;">24.7</td></tr>
    <tr><td headers="lon" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">36.6</td>
<td headers="lat" class="gt_row gt_right" style="background-color: #F2F2F2; font-weight: bold;">−2.6</td>
<td headers="ID" class="gt_row gt_right" style="background-color: #F2F2F2;">30</td>
<td headers="Jan" class="gt_row gt_right" style="background-color: #00A4AA; color: #FFFFFF;">28.2</td>
<td headers="Feb" class="gt_row gt_right" style="background-color: #C4B56E; color: #000000;">28.8</td>
<td headers="Mar" class="gt_row gt_right" style="background-color: #27C3B2; color: #000000;">28.3</td>
<td headers="Apr" class="gt_row gt_right" style="background-color: #95C650; color: #000000;">26.1</td>
<td headers="May" class="gt_row gt_right" style="background-color: #E7940E; color: #000000;">24.4</td>
<td headers="Jun" class="gt_row gt_right" style="background-color: #9FD17D; color: #000000;">23.6</td>
<td headers="Jul" class="gt_row gt_right" style="background-color: #7DB5D4; color: #000000;">22.9</td>
<td headers="Aug" class="gt_row gt_right" style="background-color: #9E9AC1; color: #FFFFFF;">23.8</td>
<td headers="Sep" class="gt_row gt_right" style="background-color: #DAAB90; color: #000000;">25.9</td>
<td headers="Oct" class="gt_row gt_right" style="background-color: #DBA86F; color: #000000;">27.5</td>
<td headers="Nov" class="gt_row gt_right" style="background-color: #B9C285; color: #000000;">27.0</td>
<td headers="Dec" class="gt_row gt_right" style="background-color: #9ABBA9; color: #000000;">27.0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>The temperature data presented in <a href="#tbl-temperature">Table&nbsp;1</a> is in wide form. Though is format is common used to store data, is rather unpopular for data analysis. Therefore we need to tranform the wide format data storage in @<a href="#tbl-temperature">Table&nbsp;1</a> to long form. The long form data storage provides numerous benefits including. Firstly, it simplifies data analysis by presenting a more organized and adaptable format for tasks like data filtering, transformation, and aggregation using functions from the tidyverse ecosystem.</p>
<p>Secondly, the long format is ideal for data visualization as it conforms to the principles of “tidy data” and the grammar of graphics, allowing for simpler plotting and exploration of relationships between variables. Additionally, converting to long format promotes consistency and organization, making it easier to manage and interpret complex datasets. Overall, utilizing tidyverse tools to transform data from wide to long format enhances data analysis, visualization, and overall data management. The function <code>pivot_longer</code> from dplyr is widely used for this transformation;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>temperatur.tb <span class="ot">=</span>  temperatur.tb <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(lon<span class="sc">:</span>ID), </span>
<span id="cb62-3"><a href="#cb62-3"></a>               <span class="at">values_to =</span> <span class="st">"temperature"</span>, </span>
<span id="cb62-4"><a href="#cb62-4"></a>               <span class="at">names_to =</span> <span class="st">"month"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">str_to_title</span>(month),</span>
<span id="cb62-6"><a href="#cb62-6"></a>         <span class="at">month =</span> forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>temperatur.tb <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="fu">fmt_integer</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="fu">cols_label_with</span>(</span>
<span id="cb63-7"><a href="#cb63-7"></a>    <span class="at">fn =</span> <span class="sc">~</span> janitor<span class="sc">::</span><span class="fu">make_clean_names</span>(., <span class="at">case =</span> <span class="st">"all_caps"</span>)</span>
<span id="cb63-8"><a href="#cb63-8"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-extract-temp" class="anchored">

<div id="hfkkbcmfnm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hfkkbcmfnm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hfkkbcmfnm thead, #hfkkbcmfnm tbody, #hfkkbcmfnm tfoot, #hfkkbcmfnm tr, #hfkkbcmfnm td, #hfkkbcmfnm th {
  border-style: none;
}

#hfkkbcmfnm p {
  margin: 0;
  padding: 0;
}

#hfkkbcmfnm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hfkkbcmfnm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hfkkbcmfnm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hfkkbcmfnm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hfkkbcmfnm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hfkkbcmfnm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hfkkbcmfnm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hfkkbcmfnm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hfkkbcmfnm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hfkkbcmfnm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hfkkbcmfnm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hfkkbcmfnm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hfkkbcmfnm .gt_spanner_row {
  border-bottom-style: hidden;
}

#hfkkbcmfnm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hfkkbcmfnm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hfkkbcmfnm .gt_from_md > :first-child {
  margin-top: 0;
}

#hfkkbcmfnm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hfkkbcmfnm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hfkkbcmfnm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hfkkbcmfnm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hfkkbcmfnm .gt_row_group_first td {
  border-top-width: 2px;
}

#hfkkbcmfnm .gt_row_group_first th {
  border-top-width: 2px;
}

#hfkkbcmfnm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfkkbcmfnm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hfkkbcmfnm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hfkkbcmfnm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hfkkbcmfnm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfkkbcmfnm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hfkkbcmfnm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hfkkbcmfnm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hfkkbcmfnm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hfkkbcmfnm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hfkkbcmfnm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfkkbcmfnm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hfkkbcmfnm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hfkkbcmfnm .gt_left {
  text-align: left;
}

#hfkkbcmfnm .gt_center {
  text-align: center;
}

#hfkkbcmfnm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hfkkbcmfnm .gt_font_normal {
  font-weight: normal;
}

#hfkkbcmfnm .gt_font_bold {
  font-weight: bold;
}

#hfkkbcmfnm .gt_font_italic {
  font-style: italic;
}

#hfkkbcmfnm .gt_super {
  font-size: 65%;
}

#hfkkbcmfnm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hfkkbcmfnm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hfkkbcmfnm .gt_indent_1 {
  text-indent: 5px;
}

#hfkkbcmfnm .gt_indent_2 {
  text-indent: 10px;
}

#hfkkbcmfnm .gt_indent_3 {
  text-indent: 15px;
}

#hfkkbcmfnm .gt_indent_4 {
  text-indent: 20px;
}

#hfkkbcmfnm .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;2:  <p>Exerpt of the monthly temperature arranged in long form</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="LON">LON</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="LAT">LAT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="MONTH">MONTH</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="TEMPERATURE">TEMPERATURE</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Jan</td>
<td headers="temperature" class="gt_row gt_right">29.800</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Feb</td>
<td headers="temperature" class="gt_row gt_right">30.300</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Mar</td>
<td headers="temperature" class="gt_row gt_right">29.400</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Apr</td>
<td headers="temperature" class="gt_row gt_right">26.700</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">May</td>
<td headers="temperature" class="gt_row gt_right">24.400</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Jun</td>
<td headers="temperature" class="gt_row gt_right">23.400</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Jul</td>
<td headers="temperature" class="gt_row gt_right">22.900</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Aug</td>
<td headers="temperature" class="gt_row gt_right">23.900</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Sep</td>
<td headers="temperature" class="gt_row gt_right">26.100</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="month" class="gt_row gt_center">Oct</td>
<td headers="temperature" class="gt_row gt_right">27.900</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>temperatur.tb <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">filter</span>(temperature <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y  =</span> temperature))<span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-month-temp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-month-temp-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;11: Boxplot of monthyl maximum temperature in Arusha Region</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Sometimes we are very interested with computing the mean and standard deviation of maximum temperature for the thirty sampling points across the twelve months of the year in order to get middle value of temperature. That can be computed with the code below.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>temp.stats <span class="ot">=</span> temperatur.tb <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),<span class="at">bar =</span> <span class="fu">mean</span>(temperature), <span class="at">sd =</span> <span class="fu">sd</span>(temperature)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In summary, the code shows a grouping of the data by month, summarizing the number of observations, the mean temperature, and the standard deviation of the temperature for each month, and then ungrouping the data frame. The resulted values include mean and standard deviation presented in <a href="#tbl-stats">Table&nbsp;3</a>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>temp.stats  <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="fu">fmt_integer</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>  <span class="fu">cols_label_with</span>(</span>
<span id="cb66-6"><a href="#cb66-6"></a>    <span class="at">fn =</span> <span class="sc">~</span> janitor<span class="sc">::</span><span class="fu">make_clean_names</span>(., <span class="at">case =</span> <span class="st">"all_caps"</span>)</span>
<span id="cb66-7"><a href="#cb66-7"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb66-8"><a href="#cb66-8"></a>  <span class="fu">data_color</span>(</span>
<span id="cb66-9"><a href="#cb66-9"></a>    <span class="at">columns =</span> bar,</span>
<span id="cb66-10"><a href="#cb66-10"></a>    <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">palette =</span> <span class="st">"ArmyRose"</span>, <span class="at">rev =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-11"><a href="#cb66-11"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb66-12"><a href="#cb66-12"></a>  <span class="fu">data_color</span>(</span>
<span id="cb66-13"><a href="#cb66-13"></a>    <span class="at">columns =</span> sd,</span>
<span id="cb66-14"><a href="#cb66-14"></a>    <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">palette =</span> <span class="st">"Earth"</span>, <span class="at">rev =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-15"><a href="#cb66-15"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-stats" class="anchored">

<div id="hkayzjacua" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hkayzjacua table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hkayzjacua thead, #hkayzjacua tbody, #hkayzjacua tfoot, #hkayzjacua tr, #hkayzjacua td, #hkayzjacua th {
  border-style: none;
}

#hkayzjacua p {
  margin: 0;
  padding: 0;
}

#hkayzjacua .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hkayzjacua .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hkayzjacua .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hkayzjacua .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hkayzjacua .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hkayzjacua .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hkayzjacua .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hkayzjacua .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hkayzjacua .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hkayzjacua .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hkayzjacua .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hkayzjacua .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hkayzjacua .gt_spanner_row {
  border-bottom-style: hidden;
}

#hkayzjacua .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hkayzjacua .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hkayzjacua .gt_from_md > :first-child {
  margin-top: 0;
}

#hkayzjacua .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hkayzjacua .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hkayzjacua .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hkayzjacua .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hkayzjacua .gt_row_group_first td {
  border-top-width: 2px;
}

#hkayzjacua .gt_row_group_first th {
  border-top-width: 2px;
}

#hkayzjacua .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkayzjacua .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hkayzjacua .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hkayzjacua .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hkayzjacua .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkayzjacua .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hkayzjacua .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hkayzjacua .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hkayzjacua .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hkayzjacua .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hkayzjacua .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkayzjacua .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hkayzjacua .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkayzjacua .gt_left {
  text-align: left;
}

#hkayzjacua .gt_center {
  text-align: center;
}

#hkayzjacua .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hkayzjacua .gt_font_normal {
  font-weight: normal;
}

#hkayzjacua .gt_font_bold {
  font-weight: bold;
}

#hkayzjacua .gt_font_italic {
  font-style: italic;
}

#hkayzjacua .gt_super {
  font-size: 65%;
}

#hkayzjacua .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hkayzjacua .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hkayzjacua .gt_indent_1 {
  text-indent: 5px;
}

#hkayzjacua .gt_indent_2 {
  text-indent: 10px;
}

#hkayzjacua .gt_indent_3 {
  text-indent: 15px;
}

#hkayzjacua .gt_indent_4 {
  text-indent: 20px;
}

#hkayzjacua .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;3:  <p>Monthly mean and standard deviation of temperature</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="MONTH">MONTH</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="N">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="BAR">BAR</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SD">SD</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #DA8093; color: #FFFFFF;">27.577</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #B58D52; color: #FFFFFF;">3.451</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #D66982; color: #FFFFFF;">28.040</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #D6C696; color: #000000;">3.379</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Mar</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #DA7E92; color: #FFFFFF;">27.603</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #C3CFBF; color: #000000;">3.294</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Apr</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #FCD7DE; color: #000000;">25.780</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #E9E4BA; color: #000000;">3.342</td></tr>
    <tr><td headers="month" class="gt_row gt_center">May</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #ABB56E; color: #000000;">23.833</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #B3884D; color: #FFFFFF;">3.457</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jun</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #96A04A; color: #FFFFFF;">23.377</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #CAD4C1; color: #000000;">3.302</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jul</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #798233; color: #FFFFFF;">22.717</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #5DA59E; color: #FFFFFF;">3.219</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Aug</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #A3AD61; color: #000000;">23.667</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #2686A0; color: #FFFFFF;">3.175</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Sep</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #FFE0E6; color: #000000;">25.620</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #CBD5C1; color: #000000;">3.303</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Oct</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #E19AA8; color: #000000;">27.023</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #AEC3B2; color: #000000;">3.274</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Nov</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #E4A5B1; color: #000000;">26.790</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #E1D8AB; color: #000000;">3.357</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Dec</td>
<td headers="n" class="gt_row gt_right">30</td>
<td headers="bar" class="gt_row gt_right" style="background-color: #E7ACB7; color: #000000;">26.637</td>
<td headers="sd" class="gt_row gt_right" style="background-color: #A36B2B; color: #FFFFFF;">3.494</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>The value of temperature shown in <a href="#tbl-stats">Table&nbsp;3</a> make it hard to see the patterns hidden in the data, but by visualizing the data with a plot, a subtle clue of the information can be revealed that clearly show the pattern as <a href="#fig-interannual">Figure&nbsp;12</a> shows.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>temp.stats <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> index, <span class="at">y =</span> bar))<span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">annotate</span>(</span>
<span id="cb67-5"><a href="#cb67-5"></a>    <span class="at">geom =</span> <span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">10</span>), <span class="at">xmax =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">12</span>), <span class="at">ymin =</span> <span class="dv">21</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb67-6"><a href="#cb67-6"></a>    <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>), <span class="at">alpha =</span> .<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb67-8"><a href="#cb67-8"></a>    <span class="fu">aes</span>(<span class="at">ymin =</span> bar<span class="sc">-</span>se, <span class="at">ymax =</span> bar<span class="sc">+</span>se), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb67-9"><a href="#cb67-9"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">labels =</span> month.abb)<span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)))<span class="sc">+</span></span>
<span id="cb67-12"><a href="#cb67-12"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-interannual" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-interannual-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;12: Inter-annual variation of maximum temperature in Arusha. The solid line is the mean and the ribbon is the standard deviation of each month across a year</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-interannual">Figure&nbsp;12</a> clearly show that in a year, the temperature in Arusha can be divided into a cool season that run from May to September and hot season, which begin from December through April. Let us use this two block of time to compute whether the temperature between these two season is statistically significant</p>
</section>
<section id="derivatives-from-raster" class="level2">
<h2 class="anchored" data-anchor-id="derivatives-from-raster">Derivatives from raster</h2>
<p>The <code>terrain</code> function in the terra package <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2023</a>)</span> provides a nifty tool for computing derivatives in hydrological modeling. It allows for the calculation of various terrain-related variables that are essential in hydrological analysis, such as slope, aspect, flow accumulation, and curvature. By utilizing the <code>terrain</code> function, you can derive important terrain derivatives that provide insights into the topographic characteristics of an area.</p>
<p>For example, the slope can be calculated to determine the steepness of the terrain, which is crucial for understanding water flow patterns. Aspect provides information on the direction of slope, aiding in understanding the orientation of water movement. Flow accumulation, another derivative that can be computed using <code>terrain</code>, helps identify areas where water is likely to accumulate, guiding the delineation of watersheds and the identification of stream networks.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>derivatives <span class="ot">=</span> arusha.elevation.mask <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2"></a>  terra<span class="sc">::</span><span class="fu">terrain</span>(<span class="fu">c</span>(<span class="st">"aspect"</span>, <span class="st">"slope"</span>, <span class="st">"flowdir"</span>))</span>
<span id="cb68-3"><a href="#cb68-3"></a></span>
<span id="cb68-4"><a href="#cb68-4"></a>derivatives</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 285, 313, 3  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 34.7, 37.30833, -4.083333, -1.708333  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source(s)   : memory
names       : aspect,    slope, flowdir 
min values  :      0,  0.00000,       0 
max values  :    360, 29.71266,     128 </code></pre>
</div>
</div>
<p>The derivatives of the elevation raster layer in Arusha are “aspect,” “slope,” and “flowdir,” representing the minimum and maximum values of derived quantities. We can visualize this derivatives with plot function from terra;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>derivatives <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-der" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-der-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;13: The aspect, slope and flow direction derived from elevation raster</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>To extract values for slope, aspect, and flow direction at those thirty sampling points, we use the terra package, with its <code>extract()</code> function. This function can retrieve the corresponding values from a raster dataset containing slope, aspect, and flow direction information to location of sampling points. The extract function allows for precise location-based extraction, enabling you to obtain the desired attribute values for each sampling point of interest. The chunk below highlights and the result are presented in <a href="#tbl-deriv">Table&nbsp;4</a>;</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>der.values <span class="ot">=</span> derivatives <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2"></a>  terra<span class="sc">::</span><span class="fu">extract</span>(sampling.points, <span class="at">xy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="fu">select</span>(<span class="at">lon =</span> x, <span class="at">lat =</span> y, ID, aspect, slope, flowdir) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>der.values  <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3"></a>  <span class="fu">fmt_number</span>(<span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-4"><a href="#cb72-4"></a>  <span class="fu">fmt_integer</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb72-5"><a href="#cb72-5"></a>  <span class="fu">cols_label_with</span>(</span>
<span id="cb72-6"><a href="#cb72-6"></a>    <span class="at">fn =</span> <span class="sc">~</span> janitor<span class="sc">::</span><span class="fu">make_clean_names</span>(., <span class="at">case =</span> <span class="st">"all_caps"</span>)</span>
<span id="cb72-7"><a href="#cb72-7"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb72-8"><a href="#cb72-8"></a>  <span class="fu">data_color</span>(</span>
<span id="cb72-9"><a href="#cb72-9"></a>    <span class="at">columns =</span> aspect,</span>
<span id="cb72-10"><a href="#cb72-10"></a>    <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">palette =</span> <span class="st">"ArmyRose"</span>, <span class="at">rev =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-11"><a href="#cb72-11"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb72-12"><a href="#cb72-12"></a>  <span class="fu">data_color</span>(</span>
<span id="cb72-13"><a href="#cb72-13"></a>    <span class="at">columns =</span> slope,</span>
<span id="cb72-14"><a href="#cb72-14"></a>    <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">palette =</span> <span class="st">"Earth"</span>, <span class="at">rev =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-15"><a href="#cb72-15"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb72-16"><a href="#cb72-16"></a>  <span class="fu">data_color</span>(</span>
<span id="cb72-17"><a href="#cb72-17"></a>    <span class="at">columns =</span> flowdir,</span>
<span id="cb72-18"><a href="#cb72-18"></a>    <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">palette =</span> <span class="st">"Reds 2"</span>, <span class="at">rev =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-19"><a href="#cb72-19"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-deriv" class="anchored">

<div id="jmborjqqij" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jmborjqqij table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jmborjqqij thead, #jmborjqqij tbody, #jmborjqqij tfoot, #jmborjqqij tr, #jmborjqqij td, #jmborjqqij th {
  border-style: none;
}

#jmborjqqij p {
  margin: 0;
  padding: 0;
}

#jmborjqqij .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jmborjqqij .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jmborjqqij .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jmborjqqij .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jmborjqqij .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jmborjqqij .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jmborjqqij .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jmborjqqij .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jmborjqqij .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jmborjqqij .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jmborjqqij .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jmborjqqij .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jmborjqqij .gt_spanner_row {
  border-bottom-style: hidden;
}

#jmborjqqij .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jmborjqqij .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jmborjqqij .gt_from_md > :first-child {
  margin-top: 0;
}

#jmborjqqij .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jmborjqqij .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jmborjqqij .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jmborjqqij .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jmborjqqij .gt_row_group_first td {
  border-top-width: 2px;
}

#jmborjqqij .gt_row_group_first th {
  border-top-width: 2px;
}

#jmborjqqij .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jmborjqqij .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jmborjqqij .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jmborjqqij .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jmborjqqij .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jmborjqqij .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jmborjqqij .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jmborjqqij .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jmborjqqij .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jmborjqqij .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jmborjqqij .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jmborjqqij .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jmborjqqij .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jmborjqqij .gt_left {
  text-align: left;
}

#jmborjqqij .gt_center {
  text-align: center;
}

#jmborjqqij .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jmborjqqij .gt_font_normal {
  font-weight: normal;
}

#jmborjqqij .gt_font_bold {
  font-weight: bold;
}

#jmborjqqij .gt_font_italic {
  font-style: italic;
}

#jmborjqqij .gt_super {
  font-size: 65%;
}

#jmborjqqij .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jmborjqqij .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jmborjqqij .gt_indent_1 {
  text-indent: 5px;
}

#jmborjqqij .gt_indent_2 {
  text-indent: 10px;
}

#jmborjqqij .gt_indent_3 {
  text-indent: 15px;
}

#jmborjqqij .gt_indent_4 {
  text-indent: 20px;
}

#jmborjqqij .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption>Table&nbsp;4:  <p>Extracted values of slope, aspect and flow direction along the thirty
sampling points in the Arusha Region</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="LON">LON</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="LAT">LAT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ASPECT">ASPECT</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SLOPE">SLOPE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="FLOWDIR">FLOWDIR</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="lon" class="gt_row gt_right">36.854</td>
<td headers="lat" class="gt_row gt_right">−3.404</td>
<td headers="ID" class="gt_row gt_right">1</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #D6DDAF; color: #000000;">151.818</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #479B9E; color: #FFFFFF;">1.719</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F0EFEF; color: #000000;">4.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.638</td>
<td headers="lat" class="gt_row gt_right">−3.021</td>
<td headers="ID" class="gt_row gt_right">2</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #DB8295; color: #FFFFFF;">327.564</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #3D979E; color: #FFFFFF;">1.326</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #EBE2E2; color: #000000;">16.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.479</td>
<td headers="lat" class="gt_row gt_right">−2.471</td>
<td headers="ID" class="gt_row gt_right">3</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #FEDCE2; color: #000000;">212.620</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #E4DEB2; color: #000000;">10.351</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F0EFEF; color: #000000;">4.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.121</td>
<td headers="lat" class="gt_row gt_right">−3.671</td>
<td headers="ID" class="gt_row gt_right">4</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #DD8C9C; color: #000000;">315.134</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2686A0; color: #FFFFFF;">0.022</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #7F000D; color: #FFFFFF;">128.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.788</td>
<td headers="lat" class="gt_row gt_right">−2.687</td>
<td headers="ID" class="gt_row gt_right">5</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #9AA451; color: #FFFFFF;">73.925</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #3E989E; color: #FFFFFF;">1.375</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #7F000D; color: #FFFFFF;">128.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.954</td>
<td headers="lat" class="gt_row gt_right">−2.938</td>
<td headers="ID" class="gt_row gt_right">6</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #E4A4AF; color: #000000;">283.607</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #33929F; color: #FFFFFF;">0.859</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #E3CBCC; color: #000000;">32.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.338</td>
<td headers="lat" class="gt_row gt_right">−2.654</td>
<td headers="ID" class="gt_row gt_right">7</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #EEBFC7; color: #000000;">247.994</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #5FA69E; color: #FFFFFF;">2.674</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #EFEBEC; color: #000000;">8.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.388</td>
<td headers="lat" class="gt_row gt_right">−3.912</td>
<td headers="ID" class="gt_row gt_right">8</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #B1BA77; color: #000000;">104.442</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2E8F9F; color: #FFFFFF;">0.623</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F1F1; color: #000000;">1.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.604</td>
<td headers="lat" class="gt_row gt_right">−2.237</td>
<td headers="ID" class="gt_row gt_right">9</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #FFDFE5; color: #000000;">209.968</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #CCD7C2; color: #000000;">7.687</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F0EFEF; color: #000000;">4.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.463</td>
<td headers="lat" class="gt_row gt_right">−1.912</td>
<td headers="ID" class="gt_row gt_right">10</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #97A14C; color: #FFFFFF;">70.162</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #9ABBA9; color: #000000;">4.980</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F1F1; color: #000000;">1.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.729</td>
<td headers="lat" class="gt_row gt_right">−2.804</td>
<td headers="ID" class="gt_row gt_right">11</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #C4CC94; color: #000000;">128.444</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2B8B9F; color: #FFFFFF;">0.375</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F0F0; color: #000000;">2.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.129</td>
<td headers="lat" class="gt_row gt_right">−3.087</td>
<td headers="ID" class="gt_row gt_right">12</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #D97D91; color: #FFFFFF;">334.089</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2B8B9F; color: #FFFFFF;">0.372</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #CA9597; color: #FFFFFF;">64.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.604</td>
<td headers="lat" class="gt_row gt_right">−2.254</td>
<td headers="ID" class="gt_row gt_right">13</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #D66982; color: #FFFFFF;">359.692</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #65A89E; color: #FFFFFF;">2.873</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #7F000D; color: #FFFFFF;">128.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.196</td>
<td headers="lat" class="gt_row gt_right">−3.704</td>
<td headers="ID" class="gt_row gt_right">14</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #E199A7; color: #000000;">297.803</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #439A9E; color: #FFFFFF;">1.583</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #E3CBCC; color: #000000;">32.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.554</td>
<td headers="lat" class="gt_row gt_right">−2.896</td>
<td headers="ID" class="gt_row gt_right">15</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #E6ECC7; color: #000000;">172.092</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #63A79E; color: #FFFFFF;">2.807</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F0F0; color: #000000;">2.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.088</td>
<td headers="lat" class="gt_row gt_right">−3.587</td>
<td headers="ID" class="gt_row gt_right">16</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #A6AF66; color: #000000;">90.000</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2686A0; color: #FFFFFF;">0.000</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #7F000D; color: #FFFFFF;">128.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.196</td>
<td headers="lat" class="gt_row gt_right">−3.537</td>
<td headers="ID" class="gt_row gt_right">17</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #E7AEB9; color: #000000;">270.000</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2686A0; color: #FFFFFF;">0.000</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #7F000D; color: #FFFFFF;">128.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.279</td>
<td headers="lat" class="gt_row gt_right">−2.712</td>
<td headers="ID" class="gt_row gt_right">18</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #E094A3; color: #000000;">303.258</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2989A0; color: #FFFFFF;">0.213</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #CA9597; color: #FFFFFF;">64.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.763</td>
<td headers="lat" class="gt_row gt_right">−3.271</td>
<td headers="ID" class="gt_row gt_right">19</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #E5EBC5; color: #000000;">170.630</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #A36B2B; color: #FFFFFF;">18.856</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F0EFEF; color: #000000;">4.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.788</td>
<td headers="lat" class="gt_row gt_right">−3.421</td>
<td headers="ID" class="gt_row gt_right">20</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #D4DBAD; color: #000000;">149.901</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #4A9D9E; color: #FFFFFF;">1.850</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F1F1; color: #000000;">1.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.463</td>
<td headers="lat" class="gt_row gt_right">−1.804</td>
<td headers="ID" class="gt_row gt_right">21</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #808080; color: #FFFFFF;">NA</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #808080; color: #FFFFFF;">NA</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #EFEBEC; color: #000000;">8.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.579</td>
<td headers="lat" class="gt_row gt_right">−3.737</td>
<td headers="ID" class="gt_row gt_right">22</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #D76D85; color: #FFFFFF;">354.900</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #39959E; color: #FFFFFF;">1.131</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #E3CBCC; color: #000000;">32.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.054</td>
<td headers="lat" class="gt_row gt_right">−2.462</td>
<td headers="ID" class="gt_row gt_right">23</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #D5DCAE; color: #000000;">151.086</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2787A0; color: #FFFFFF;">0.080</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F0F0; color: #000000;">2.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.338</td>
<td headers="lat" class="gt_row gt_right">−2.671</td>
<td headers="ID" class="gt_row gt_right">24</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #EBB9C2; color: #000000;">255.548</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #6DAA9F; color: #FFFFFF;">3.173</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #EBE2E2; color: #000000;">16.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.646</td>
<td headers="lat" class="gt_row gt_right">−2.687</td>
<td headers="ID" class="gt_row gt_right">25</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #AFB975; color: #000000;">102.794</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #30909F; color: #FFFFFF;">0.737</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F0F0; color: #000000;">2.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.746</td>
<td headers="lat" class="gt_row gt_right">−3.304</td>
<td headers="ID" class="gt_row gt_right">26</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #FFE8ED; color: #000000;">200.702</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #D0BC88; color: #000000;">12.882</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F0EFEF; color: #000000;">4.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.704</td>
<td headers="lat" class="gt_row gt_right">−2.454</td>
<td headers="ID" class="gt_row gt_right">27</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #9DA757; color: #FFFFFF;">78.626</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #2A8AA0; color: #FFFFFF;">0.276</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F1F1; color: #000000;">1.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.238</td>
<td headers="lat" class="gt_row gt_right">−2.537</td>
<td headers="ID" class="gt_row gt_right">28</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #B1BA78; color: #000000;">104.757</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #3D979E; color: #FFFFFF;">1.342</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F1F1F1; color: #000000;">1.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">35.221</td>
<td headers="lat" class="gt_row gt_right">−3.154</td>
<td headers="ID" class="gt_row gt_right">29</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #798233; color: #FFFFFF;">27.029</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #4F9F9E; color: #FFFFFF;">2.041</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #CA9597; color: #FFFFFF;">64.000</td></tr>
    <tr><td headers="lon" class="gt_row gt_right">36.604</td>
<td headers="lat" class="gt_row gt_right">−2.637</td>
<td headers="ID" class="gt_row gt_right">30</td>
<td headers="aspect" class="gt_row gt_right" style="background-color: #F4F7DD; color: #000000;">188.698</td>
<td headers="slope" class="gt_row gt_right" style="background-color: #3B969E; color: #FFFFFF;">1.226</td>
<td headers="flowdir" class="gt_row gt_right" style="background-color: #F0EFEF; color: #000000;">4.000</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>The extracted values presented in <a href="#tbl-deriv">Table&nbsp;4</a> can be integrate them to your analysis or modeling workflows, facilitating further exploration and interpretation of slope, aspect, and flow direction information in the context of your specific study or application.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this tutorial, we have covered the basics of handling spatial data in R. We have learned how to import point, line, polygon, and raster data using the <strong>sf</strong> and <strong>terra</strong> packages. We have also learned how to manipulate spatial data using various functions provided by these packages. With these tools, you can explore and analyze spatial data in R with ease.</p>
</section>
</section>
<section id="appendix" class="level1 unnumbered">
<h1 class="unnumbered">Appendix</h1>
<section id="vector-data-issues" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="vector-data-issues">vector data issues</h2>
<p>Upon examining the dataset for regions in Tanzania, it has come to our attention that there are 32 layers instead of the expected 31, representing each region. This anomaly prompts us to conduct a thorough investigation to identify the additional layer and understand its nature. By exploring the dataset in detail, we can ascertain the reason for this additional layer, whether it represents a new region, a duplicate entry, or any other relevant information. This detailed exploration will aid in ensuring data accuracy and reliability, allowing us to make informed decisions and draw accurate conclusions based on the region-specific information within the dataset.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>regions <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="fu">select</span>(<span class="at">name =</span> TZ_REGIONA) <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb73-4"><a href="#cb73-4"></a>  janitor<span class="sc">::</span><span class="fu">get_dupes</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   name dupe_count
1 PWANI          2
2 PWANI          2</code></pre>
</div>
</div>
<p>It has come to our attention that the Pwani region in Tanzania consists of two distinct layers. This is due to the fact that the district of Mafia Island is treated as a separate feature in the dataset. While this may seem like a minor detail, it is important to note as it can affect the way data is analyzed and interpreted. It is crucial to take into account all features and layers within a region to ensure accurate and comprehensive analysis. As professionals, it is our responsibility to thoroughly examine all aspects of a dataset to ensure the most reliable results possible. By acknowledging and understanding the distinct layers within the Pwani region, we can ensure a more thorough and accurate analysis of the data.</p>
</section>
<section id="spatial-resolution-in-raster" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="spatial-resolution-in-raster">Spatial resolution in Raster</h2>
<p>Spatial resolution in raster dataset refers to detail or granularity at which spatial features are represented in the dataset. It indicates the size of the smallest discernible feature that can be captured and displayed by each pixel in the raster.</p>
<p>A higher spatial resolution means that each pixel represents a smaller area on the ground, resulting in more detailed and precise representations of spatial features. This is achieved by increasing the number of pixels per unit area, allowing for a finer level of discrimination.</p>
<p>On the other hand, decreasing the spatial resolution results in larger pixel sizes, which leads to a loss of detail. As the pixel size increases, smaller features and subtle variations within the data become less distinguishable or completely lost. This reduction in spatial resolution can lead to a loss of important information and may impact the accuracy and reliability of subsequent analyses or interpretations.</p>
<p>Let’s read and import elevation layer from</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>elevation <span class="ot">=</span> <span class="fu">rast</span>(<span class="st">"data/elevation_arusha.tif"</span>)</span>
<span id="cb75-2"><a href="#cb75-2"></a>elevation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatRaster 
dimensions  : 285, 313, 1  (nrow, ncol, nlyr)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : 34.7, 37.30833, -4.083333, -1.708333  (xmin, xmax, ymin, ymax)
coord. ref. : lon/lat WGS 84 (EPSG:4326) 
source      : elevation_arusha.tif 
name        : TZA_wc2.1_30s_elev 
min value   :                595 
max value   :               4222 </code></pre>
</div>
</div>
<p>Upon examination, we have observed that the raster dataset has a spatial resolution of 0.0083333, which is expressed in degrees. To better understand the implications of this resolution in metric measurements, a useful rule of thumb is to multiply it by 110 for areas near the equator. By applying this conversion factor, we can estimate the approximate metric equivalent of the spatial resolution, providing a clearer understanding of the scale and size represented by each pixel in the raster dataset.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># 1 degree = 110 km</span></span>
<span id="cb77-2"><a href="#cb77-2"></a></span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="fl">0.008333333</span><span class="sc">*</span><span class="dv">110</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9166666</code></pre>
</div>
</div>
<p>Then, use the <code>aggregate</code> function to resample the elevation raster to a lower resolution. We will decrease the resolution by ten and thirty folds.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>ele10 <span class="ot">=</span> elevation <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2"></a>  <span class="fu">aggregate</span>(<span class="at">fact =</span> <span class="dv">10</span>, <span class="at">fun =</span> <span class="st">"mean"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3"></a>  <span class="fu">extend</span>(elevation)</span>
<span id="cb79-4"><a href="#cb79-4"></a></span>
<span id="cb79-5"><a href="#cb79-5"></a>ele30 <span class="ot">=</span> elevation <span class="sc">%&gt;%</span> </span>
<span id="cb79-6"><a href="#cb79-6"></a>  <span class="fu">aggregate</span>(<span class="at">fact =</span> <span class="dv">30</span>, <span class="at">fun =</span> <span class="st">"mean"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-7"><a href="#cb79-7"></a>  <span class="fu">extend</span>(elevation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb80-2"><a href="#cb80-2"></a></span>
<span id="cb80-3"><a href="#cb80-3"></a>elevation <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4"></a>  <span class="fu">plot</span>(<span class="at">main =</span> <span class="st">"Resolution: 1km"</span>)</span>
<span id="cb80-5"><a href="#cb80-5"></a></span>
<span id="cb80-6"><a href="#cb80-6"></a>ele10 <span class="sc">%&gt;%</span> </span>
<span id="cb80-7"><a href="#cb80-7"></a>  <span class="fu">plot</span>(<span class="at">main =</span> <span class="st">"Resolution: 10km"</span>)</span>
<span id="cb80-8"><a href="#cb80-8"></a></span>
<span id="cb80-9"><a href="#cb80-9"></a>ele30 <span class="sc">%&gt;%</span> </span>
<span id="cb80-10"><a href="#cb80-10"></a>  <span class="fu">plot</span>(<span class="at">main =</span> <span class="st">"Resolution: 30km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="session-information" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="session-information">Session Information</h2>
<p>I have generated the information that of the machine software and packages that were used to generate this minimal book for the exercise on spatial data Types. This information includes the version of R used, the operating system, attached packages, and other relevant details.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.0 (2023-04-21 ucrt)
 os       Windows 11 x64 (build 22621)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  English_Tanzania.utf8
 ctype    English_Tanzania.utf8
 tz       Africa/Dar_es_Salaam
 date     2023-06-23
 pandoc   3.1.1 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package     * version date (UTC) lib source
 class         7.3-21  2023-01-23 [2] CRAN (R 4.3.0)
 classInt      0.4-9   2023-02-28 [1] CRAN (R 4.3.0)
 cli           3.6.1   2023-03-23 [1] CRAN (R 4.3.0)
 codetools     0.2-19  2023-02-01 [2] CRAN (R 4.3.0)
 colorspace    2.1-0   2023-01-23 [1] CRAN (R 4.3.0)
 data.table    1.14.8  2023-02-17 [1] CRAN (R 4.3.0)
 DBI           1.1.3   2022-06-18 [1] CRAN (R 4.3.0)
 digest        0.6.31  2022-12-11 [1] CRAN (R 4.3.0)
 dplyr       * 1.1.2   2023-04-20 [1] CRAN (R 4.3.0)
 e1071         1.7-13  2023-02-01 [1] CRAN (R 4.3.0)
 evaluate      0.21    2023-05-05 [1] CRAN (R 4.3.0)
 fansi         1.0.4   2023-01-22 [1] CRAN (R 4.3.0)
 farver        2.1.1   2022-07-06 [1] CRAN (R 4.3.0)
 fastmap       1.1.1   2023-02-24 [1] CRAN (R 4.3.0)
 forcats     * 1.0.0   2023-01-29 [1] CRAN (R 4.3.0)
 generics      0.1.3   2022-07-05 [1] CRAN (R 4.3.0)
 ggplot2     * 3.4.2   2023-04-03 [1] CRAN (R 4.3.0)
 ggspatial     1.1.8   2023-04-13 [1] CRAN (R 4.3.0)
 glue          1.6.2   2022-02-24 [1] CRAN (R 4.3.0)
 gt          * 0.9.0   2023-03-31 [1] CRAN (R 4.3.0)
 gtable        0.3.3   2023-03-21 [1] CRAN (R 4.3.0)
 hms           1.1.3   2023-03-21 [1] CRAN (R 4.3.0)
 htmltools     0.5.5   2023-03-23 [1] CRAN (R 4.3.0)
 htmlwidgets   1.6.2   2023-03-17 [1] CRAN (R 4.3.0)
 isoband       0.2.7   2022-12-20 [1] CRAN (R 4.3.0)
 janitor       2.2.0   2023-02-02 [1] CRAN (R 4.3.0)
 jsonlite      1.8.5   2023-06-05 [1] CRAN (R 4.3.0)
 KernSmooth    2.23-20 2021-05-03 [2] CRAN (R 4.3.0)
 knitr         1.43    2023-05-25 [1] CRAN (R 4.3.0)
 labeling      0.4.2   2020-10-20 [1] CRAN (R 4.3.0)
 lattice       0.21-8  2023-04-05 [2] CRAN (R 4.3.0)
 lifecycle     1.0.3   2022-10-07 [1] CRAN (R 4.3.0)
 lubridate   * 1.9.2   2023-02-10 [1] CRAN (R 4.3.0)
 magrittr      2.0.3   2022-03-30 [1] CRAN (R 4.3.0)
 munsell       0.5.0   2018-06-12 [1] CRAN (R 4.3.0)
 pillar        1.9.0   2023-03-22 [1] CRAN (R 4.3.0)
 pkgconfig     2.0.3   2019-09-22 [1] CRAN (R 4.3.0)
 plyr          1.8.8   2022-11-11 [1] CRAN (R 4.3.0)
 png           0.1-8   2022-11-29 [1] CRAN (R 4.3.0)
 prettymapr    0.2.4   2022-06-09 [1] CRAN (R 4.3.0)
 proxy         0.4-27  2022-06-09 [1] CRAN (R 4.3.0)
 purrr       * 1.0.1   2023-01-10 [1] CRAN (R 4.3.0)
 R6            2.5.1   2021-08-19 [1] CRAN (R 4.3.0)
 Rcpp          1.0.10  2023-01-22 [1] CRAN (R 4.3.0)
 readr       * 2.1.4   2023-02-10 [1] CRAN (R 4.3.0)
 rgdal         1.6-7   2023-05-31 [1] CRAN (R 4.3.0)
 rlang         1.1.1   2023-04-28 [1] CRAN (R 4.3.0)
 rmarkdown     2.22    2023-06-01 [1] CRAN (R 4.3.0)
 rosm          0.2.6   2022-06-09 [1] CRAN (R 4.3.0)
 rstudioapi    0.14    2022-08-22 [1] CRAN (R 4.3.0)
 sass          0.4.6   2023-05-03 [1] CRAN (R 4.3.0)
 scales        1.2.1   2022-08-20 [1] CRAN (R 4.3.0)
 sessioninfo   1.2.2   2021-12-06 [1] CRAN (R 4.3.0)
 sf          * 1.0-13  2023-05-29 [1] Github (r-spatial/sf@b36390d)
 snakecase     0.11.0  2019-05-25 [1] CRAN (R 4.3.0)
 sp            1.6-1   2023-05-31 [1] CRAN (R 4.3.0)
 stringi       1.7.12  2023-01-11 [1] CRAN (R 4.3.0)
 stringr     * 1.5.0   2022-12-02 [1] CRAN (R 4.3.0)
 terra       * 1.7-37  2023-06-18 [1] CRAN (R 4.3.0)
 tibble      * 3.2.1   2023-03-20 [1] CRAN (R 4.3.0)
 tidyr       * 1.3.0   2023-01-24 [1] CRAN (R 4.3.0)
 tidyselect    1.2.0   2022-10-10 [1] CRAN (R 4.3.0)
 tidyterra     0.4.0   2023-03-17 [1] CRAN (R 4.3.0)
 tidyverse   * 2.0.0   2023-02-22 [1] CRAN (R 4.3.0)
 timechange    0.2.0   2023-01-11 [1] CRAN (R 4.3.0)
 tzdb          0.4.0   2023-05-12 [1] CRAN (R 4.3.0)
 units         0.8-2   2023-04-27 [1] CRAN (R 4.3.0)
 utf8          1.2.3   2023-01-31 [1] CRAN (R 4.3.0)
 vctrs         0.6.2   2023-04-19 [1] CRAN (R 4.3.0)
 withr         2.5.0   2022-03-03 [1] CRAN (R 4.3.0)
 xfun          0.39    2023-04-20 [1] CRAN (R 4.3.0)
 xml2          1.3.4   2023-04-27 [1] CRAN (R 4.3.0)
 yaml          2.3.7   2023-01-23 [1] CRAN (R 4.3.0)

 [1] C:/Users/pc/AppData/Local/R/win-library/4.3
 [2] C:/Program Files/R/R-4.3.0/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</section>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-tidyterra" class="csl-entry" role="listitem">
Hernangómez, Diego. 2023. <em><span class="nocase">tidyterra</span>: Tidyverse Methods and Ggplot2 Helpers for Terra Objects</em> (version 0.4.0). <a href="https://doi.org/10.5281/zenodo.6572471">https://doi.org/10.5281/zenodo.6572471</a>.
</div>
<div id="ref-terra" class="csl-entry" role="listitem">
Hijmans, Robert J. 2023. <em>Terra: Spatial Data Analysis</em>. <a href="https://CRAN.R-project.org/package=terra">https://CRAN.R-project.org/package=terra</a>.
</div>
<div id="ref-sf" class="csl-entry" role="listitem">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R: Standardized Support for Spatial Vector Data</span>.”</span> <em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-rlanguage" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-geomarine" class="csl-entry" role="listitem">
Semba, Masumbuko. <span>“<span>P</span>ractical <span>S</span>patial <span>D</span>ata — Lugoga.github.io.”</span> <a href="https://lugoga.github.io/geomarine/" class="uri">https://lugoga.github.io/geomarine/</a>.
</div>
<div id="ref-wior" class="csl-entry" role="listitem">
Semba, Masumbuko, and Nyamisi Peter. 2023. <em>Wior: Easy Tidy and Process Oceanographic Data</em>. <a href="https://github.com/lugoga/wior">https://github.com/lugoga/wior</a>.
</div>
<div id="ref-geospatial" class="csl-entry" role="listitem">
Semba, Masumbuko, Nyamisi Peter, and Benjamini Andrew. <span>“<span>G</span>eospatial <span>T</span>echnology and <span>S</span>patial <span>A</span>nalysis in <span>R</span> — Lugoga.github.io.”</span> <a href="https://lugoga.github.io/spatialgoR/" class="uri">https://lugoga.github.io/spatialgoR/</a>.
</div>
<div id="ref-ggplot" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>